!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).shexExtensionMap=e()}}(function(){return function(){return function e(t,r,n){function i(a,o){if(!r[a]){if(!t[a]){var u="function"==typeof require&&require;if(!o&&u)return u(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){return i(t[a][1][e]||e)},l,l.exports,e,t,r,n)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}}()({1:[function(e,t,r){var n,i=(n=e("underscore"),{collapseSpaces:function(e){return e.replace(/  +/g," ")},trimQuotes:function(e){return n.isUndefined(e)||e.length<2?e:'"'!==e[0]&&"'"!==e[0]||e[0]!==e[e.length-1]?e:e.substring(1,e.length-1)},unescapeMetaChars:function(e){return e.replace(/\\([\/^$])/g,"$1")}});void 0!==e&&void 0!==r&&(t.exports=i)},{underscore:5}],2:[function(e,t,r){var n=function(){var t=e("underscore"),r=e("./hashmap_extension"),n=e("./regex_extension");e("./extension-utils");function i(e){if(t.isEmpty(e))throw Error("Invalid extension function: "+e+"!");var r=(e=e.trim()).indexOf("(",0),n=e.lastIndexOf(")");if(r<2||n<4||n<=r+1||n!=e.length-1)throw Error("Invalid extension function: "+e+"!");return{name:e.substring(0,r),args:e.substring(r+1,n)}}return{lift:function(e,t,s){var a=i(e);switch(a.name){case"hashmap":return r.lift(e,t,s,a.args);case"regex":return n.lift(e,t,s,a.args);case"test":return e;default:throw Error("Unknown extension: "+e+"!")}},lower:function(e,t,s){var a=i(e);switch(a.name){case"hashmap":return r.lower(e,t,s,a.args);case"regex":return n.lower(e,t,s,a.args);case"test":return e;default:throw Error("Unknown extension: "+e+"!")}}}}();void 0!==e&&void 0!==r&&(t.exports=n)},{"./extension-utils":1,"./hashmap_extension":3,"./regex_extension":4,underscore:5}],3:[function(e,t,r){var n=function(){var t=e("underscore"),r=e("util"),n=e("./extension-utils");function i(e,r){if(t.isEmpty(r))throw Error("Hashmap extension requires a variable name and map as arguments, but found none!");var n=/^[ ]*([\w:<>]+)[ ]*,[ ]*({.*)$/.exec(r);if(t.isNull(n)||n.length<3)throw Error("Hashmap extension requires a variable name and map as arguments, but found: "+e+"!");var i,s=n[1],a=n[2];try{if(i=JSON.parse(a),t.isEmpty(i))throw Error("Empty hashmap!")}catch(t){throw Error("Hashmap extension unable to parse map in "+e+"!"+t.message)}var o=t.values(i);if(o.length!=t.uniq(o).length)throw Error("Hashmap extension requires unique key/value pairs!");return{varName:s,hash:i}}function s(e,r){var n=e.match(/^([\w]+):(.*)$/);if(t.isNull(n)||3!=n.length)expandedName=e;else{var i=n[1],s=n[2];if(t.isEmpty(i)||t.isEmpty(s))throw Error("Hashmap extension given invalid target variable name "+e);if(t.isUndefined(r[i]))throw Error("Hashmap extension given undefined variable prefix "+i);expandedName=r[i]+s}return expandedName}return{lift:function(e,r,a,o){var u=i(e,o),c=s(u.varName,a),l=n.trimQuotes(r);if(t.isEmpty(l))throw Error("Hashmap extension has no input");return{[c]:u.hash[l]}},lower:function(e,a,o,u){var c=i(e,u),l=s(c.varName,o),f=n.trimQuotes(a.get(l));if(t.isUndefined(f))throw Error("Unable to find mapped value for "+c.varName);var h=function(e,n){var i=t.find(t.keys(e),function(t){return n===e[t]});if(t.isEmpty(i))throw Error("Hashmap extension was unable to invert the value "+n+" with map "+r.inspect(e,{depth:null})+"!");return i}(c.hash,f);return t.isEmpty(h)?h:n.unescapeMetaChars(n.collapseSpaces(h))}}}();void 0!==e&&void 0!==r&&(t.exports=n)},{"./extension-utils":1,underscore:5,util:47}],4:[function(e,t,r){var n=function(){var t=e("underscore"),r=e("./extension-utils"),n="(\\?<(?:[a-zA-Z:]+|<[^>]+>)>)";function i(e,n,i){var s=function(e,r){var n,i=e.match(/^ *(?:<([^>]*)>|([^:]*):([^ ]*)) *$/);if(t.isNull(i))throw Error('variable "'+e+'" did not match expected pattern!');if(i[1])n=i[1];else{if(!(i[2]in r))throw Error("Unknown prefix "+i[2]+' in "'+e+'"!');n=r[i[2]]+i[3]}return n}(r.unescapeMetaChars(e.substr(2,e.length-3)),i);if(!t.isUndefined(n[s]))throw Error("unable to process prefixes in "+s);return n.push(s),s}function s(e){if(/^\s*\/.*\/\s*$/.test(e)&&(e=/^\s*\/(.*)\/\s*$/.exec(e)[1]).length<1)throw Error(mapDirective+" is missing the required regex pattern");return e}return{lift:function(e,r,a,o){var u,c=[],l=(o=s(o)).replace(RegExp(n,"g"),function(e,t,r,n){return i(t,c,a),""});if(t.isEmpty(c))throw Error("Found no capture variable in "+e+"!");try{u=r.match(RegExp(l))}catch(t){throw Error("Error pattern matching "+e+" with "+r+": "+t.message)}if(!u)throw Error(e+' found no match for input "'+r+'"!');for(var f={},h=1;h<u.length;++h)f[c[h-1]]=u[h];return f},lower:function(e,a,o,u){var c=[],l=!1,f=(u=s(u)).replace(RegExp("\\("+n+"[^)]+\\)","g"),function(n,s,u,f){l=!0;var h=i(s,c,o),p=a.get(h);if(t.isUndefined(p))throw Error("Unable to process "+e+' because variable "'+h+'" was not found!');return r.trimQuotes(p)});if(!l)throw Error("Found no capture variable in "+e+"!");return f=r.collapseSpaces(f),r.unescapeMetaChars(f)}}}();void 0!==e&&void 0!==r&&(t.exports=n)},{"./extension-utils":1,underscore:5}],5:[function(e,t,r){(function(){var e=this,n=e._,i=Array.prototype,s=Object.prototype,a=Function.prototype,o=i.push,u=i.slice,c=s.toString,l=s.hasOwnProperty,f=Array.isArray,h=Object.keys,p=a.bind,d=Object.create,v=function(){},g=function(e){return e instanceof g?e:this instanceof g?void(this._wrapped=e):new g(e)};void 0!==r?(void 0!==t&&t.exports&&(r=t.exports=g),r._=g):e._=g,g.VERSION="1.8.3";var y=function(e,t,r){if(void 0===t)return e;switch(null==r?3:r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)};case 4:return function(r,n,i,s){return e.call(t,r,n,i,s)}}return function(){return e.apply(t,arguments)}},m=function(e,t,r){return null==e?g.identity:g.isFunction(e)?y(e,t,r):g.isObject(e)?g.matcher(e):g.property(e)};g.iteratee=function(e,t){return m(e,t,1/0)};var b=function(e,t){return function(r){var n=arguments.length;if(n<2||null==r)return r;for(var i=1;i<n;i++)for(var s=arguments[i],a=e(s),o=a.length,u=0;u<o;u++){var c=a[u];t&&void 0!==r[c]||(r[c]=s[c])}return r}},_=function(e){if(!g.isObject(e))return{};if(d)return d(e);v.prototype=e;var t=new v;return v.prototype=null,t},x=function(e){return function(t){return null==t?void 0:t[e]}},w=Math.pow(2,53)-1,S=x("length"),E=function(e){var t=S(e);return"number"==typeof t&&t>=0&&t<=w};function j(e){return function(t,r,n,i){r=y(r,i,4);var s=!E(t)&&g.keys(t),a=(s||t).length,o=e>0?0:a-1;return arguments.length<3&&(n=t[s?s[o]:o],o+=e),function(t,r,n,i,s,a){for(;s>=0&&s<a;s+=e){var o=i?i[s]:s;n=r(n,t[o],o,t)}return n}(t,r,n,s,o,a)}}g.each=g.forEach=function(e,t,r){var n,i;if(t=y(t,r),E(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var s=g.keys(e);for(n=0,i=s.length;n<i;n++)t(e[s[n]],s[n],e)}return e},g.map=g.collect=function(e,t,r){t=m(t,r);for(var n=!E(e)&&g.keys(e),i=(n||e).length,s=Array(i),a=0;a<i;a++){var o=n?n[a]:a;s[a]=t(e[o],o,e)}return s},g.reduce=g.foldl=g.inject=j(1),g.reduceRight=g.foldr=j(-1),g.find=g.detect=function(e,t,r){var n;if(void 0!==(n=E(e)?g.findIndex(e,t,r):g.findKey(e,t,r))&&-1!==n)return e[n]},g.filter=g.select=function(e,t,r){var n=[];return t=m(t,r),g.each(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n},g.reject=function(e,t,r){return g.filter(e,g.negate(m(t)),r)},g.every=g.all=function(e,t,r){t=m(t,r);for(var n=!E(e)&&g.keys(e),i=(n||e).length,s=0;s<i;s++){var a=n?n[s]:s;if(!t(e[a],a,e))return!1}return!0},g.some=g.any=function(e,t,r){t=m(t,r);for(var n=!E(e)&&g.keys(e),i=(n||e).length,s=0;s<i;s++){var a=n?n[s]:s;if(t(e[a],a,e))return!0}return!1},g.contains=g.includes=g.include=function(e,t,r,n){return E(e)||(e=g.values(e)),("number"!=typeof r||n)&&(r=0),g.indexOf(e,t,r)>=0},g.invoke=function(e,t){var r=u.call(arguments,2),n=g.isFunction(t);return g.map(e,function(e){var i=n?t:e[t];return null==i?i:i.apply(e,r)})},g.pluck=function(e,t){return g.map(e,g.property(t))},g.where=function(e,t){return g.filter(e,g.matcher(t))},g.findWhere=function(e,t){return g.find(e,g.matcher(t))},g.max=function(e,t,r){var n,i,s=-1/0,a=-1/0;if(null==t&&null!=e)for(var o=0,u=(e=E(e)?e:g.values(e)).length;o<u;o++)(n=e[o])>s&&(s=n);else t=m(t,r),g.each(e,function(e,r,n){((i=t(e,r,n))>a||i===-1/0&&s===-1/0)&&(s=e,a=i)});return s},g.min=function(e,t,r){var n,i,s=1/0,a=1/0;if(null==t&&null!=e)for(var o=0,u=(e=E(e)?e:g.values(e)).length;o<u;o++)(n=e[o])<s&&(s=n);else t=m(t,r),g.each(e,function(e,r,n){((i=t(e,r,n))<a||i===1/0&&s===1/0)&&(s=e,a=i)});return s},g.shuffle=function(e){for(var t,r=E(e)?e:g.values(e),n=r.length,i=Array(n),s=0;s<n;s++)(t=g.random(0,s))!==s&&(i[s]=i[t]),i[t]=r[s];return i},g.sample=function(e,t,r){return null==t||r?(E(e)||(e=g.values(e)),e[g.random(e.length-1)]):g.shuffle(e).slice(0,Math.max(0,t))},g.sortBy=function(e,t,r){return t=m(t,r),g.pluck(g.map(e,function(e,r,n){return{value:e,index:r,criteria:t(e,r,n)}}).sort(function(e,t){var r=e.criteria,n=t.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return e.index-t.index}),"value")};var k=function(e){return function(t,r,n){var i={};return r=m(r,n),g.each(t,function(n,s){var a=r(n,s,t);e(i,n,a)}),i}};g.groupBy=k(function(e,t,r){g.has(e,r)?e[r].push(t):e[r]=[t]}),g.indexBy=k(function(e,t,r){e[r]=t}),g.countBy=k(function(e,t,r){g.has(e,r)?e[r]++:e[r]=1}),g.toArray=function(e){return e?g.isArray(e)?u.call(e):E(e)?g.map(e,g.identity):g.values(e):[]},g.size=function(e){return null==e?0:E(e)?e.length:g.keys(e).length},g.partition=function(e,t,r){t=m(t,r);var n=[],i=[];return g.each(e,function(e,r,s){(t(e,r,s)?n:i).push(e)}),[n,i]},g.first=g.head=g.take=function(e,t,r){if(null!=e)return null==t||r?e[0]:g.initial(e,e.length-t)},g.initial=function(e,t,r){return u.call(e,0,Math.max(0,e.length-(null==t||r?1:t)))},g.last=function(e,t,r){if(null!=e)return null==t||r?e[e.length-1]:g.rest(e,Math.max(0,e.length-t))},g.rest=g.tail=g.drop=function(e,t,r){return u.call(e,null==t||r?1:t)},g.compact=function(e){return g.filter(e,g.identity)};var O=function(e,t,r,n){for(var i=[],s=0,a=n||0,o=S(e);a<o;a++){var u=e[a];if(E(u)&&(g.isArray(u)||g.isArguments(u))){t||(u=O(u,t,r));var c=0,l=u.length;for(i.length+=l;c<l;)i[s++]=u[c++]}else r||(i[s++]=u)}return i};function I(e){return function(t,r,n){r=m(r,n);for(var i=S(t),s=e>0?0:i-1;s>=0&&s<i;s+=e)if(r(t[s],s,t))return s;return-1}}function T(e,t,r){return function(n,i,s){var a=0,o=S(n);if("number"==typeof s)e>0?a=s>=0?s:Math.max(s+o,a):o=s>=0?Math.min(s+1,o):s+o+1;else if(r&&s&&o)return n[s=r(n,i)]===i?s:-1;if(i!=i)return(s=t(u.call(n,a,o),g.isNaN))>=0?s+a:-1;for(s=e>0?a:o-1;s>=0&&s<o;s+=e)if(n[s]===i)return s;return-1}}g.flatten=function(e,t){return O(e,t,!1)},g.without=function(e){return g.difference(e,u.call(arguments,1))},g.uniq=g.unique=function(e,t,r,n){g.isBoolean(t)||(n=r,r=t,t=!1),null!=r&&(r=m(r,n));for(var i=[],s=[],a=0,o=S(e);a<o;a++){var u=e[a],c=r?r(u,a,e):u;t?(a&&s===c||i.push(u),s=c):r?g.contains(s,c)||(s.push(c),i.push(u)):g.contains(i,u)||i.push(u)}return i},g.union=function(){return g.uniq(O(arguments,!0,!0))},g.intersection=function(e){for(var t=[],r=arguments.length,n=0,i=S(e);n<i;n++){var s=e[n];if(!g.contains(t,s)){for(var a=1;a<r&&g.contains(arguments[a],s);a++);a===r&&t.push(s)}}return t},g.difference=function(e){var t=O(arguments,!0,!0,1);return g.filter(e,function(e){return!g.contains(t,e)})},g.zip=function(){return g.unzip(arguments)},g.unzip=function(e){for(var t=e&&g.max(e,S).length||0,r=Array(t),n=0;n<t;n++)r[n]=g.pluck(e,n);return r},g.object=function(e,t){for(var r={},n=0,i=S(e);n<i;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r},g.findIndex=I(1),g.findLastIndex=I(-1),g.sortedIndex=function(e,t,r,n){for(var i=(r=m(r,n,1))(t),s=0,a=S(e);s<a;){var o=Math.floor((s+a)/2);r(e[o])<i?s=o+1:a=o}return s},g.indexOf=T(1,g.findIndex,g.sortedIndex),g.lastIndexOf=T(-1,g.findLastIndex),g.range=function(e,t,r){null==t&&(t=e||0,e=0),r=r||1;for(var n=Math.max(Math.ceil((t-e)/r),0),i=Array(n),s=0;s<n;s++,e+=r)i[s]=e;return i};var A=function(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var s=_(e.prototype),a=e.apply(s,i);return g.isObject(a)?a:s};g.bind=function(e,t){if(p&&e.bind===p)return p.apply(e,u.call(arguments,1));if(!g.isFunction(e))throw new TypeError("Bind must be called on a function");var r=u.call(arguments,2),n=function(){return A(e,n,t,this,r.concat(u.call(arguments)))};return n},g.partial=function(e){var t=u.call(arguments,1),r=function(){for(var n=0,i=t.length,s=Array(i),a=0;a<i;a++)s[a]=t[a]===g?arguments[n++]:t[a];for(;n<arguments.length;)s.push(arguments[n++]);return A(e,r,this,this,s)};return r},g.bindAll=function(e){var t,r,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(t=1;t<n;t++)e[r=arguments[t]]=g.bind(e[r],e);return e},g.memoize=function(e,t){var r=function(n){var i=r.cache,s=""+(t?t.apply(this,arguments):n);return g.has(i,s)||(i[s]=e.apply(this,arguments)),i[s]};return r.cache={},r},g.delay=function(e,t){var r=u.call(arguments,2);return setTimeout(function(){return e.apply(null,r)},t)},g.defer=g.partial(g.delay,g,1),g.throttle=function(e,t,r){var n,i,s,a=null,o=0;r||(r={});var u=function(){o=!1===r.leading?0:g.now(),a=null,s=e.apply(n,i),a||(n=i=null)};return function(){var c=g.now();o||!1!==r.leading||(o=c);var l=t-(c-o);return n=this,i=arguments,l<=0||l>t?(a&&(clearTimeout(a),a=null),o=c,s=e.apply(n,i),a||(n=i=null)):a||!1===r.trailing||(a=setTimeout(u,l)),s}},g.debounce=function(e,t,r){var n,i,s,a,o,u=function(){var c=g.now()-a;c<t&&c>=0?n=setTimeout(u,t-c):(n=null,r||(o=e.apply(s,i),n||(s=i=null)))};return function(){s=this,i=arguments,a=g.now();var c=r&&!n;return n||(n=setTimeout(u,t)),c&&(o=e.apply(s,i),s=i=null),o}},g.wrap=function(e,t){return g.partial(t,e)},g.negate=function(e){return function(){return!e.apply(this,arguments)}},g.compose=function(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}},g.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},g.before=function(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}},g.once=g.partial(g.before,2);var N=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function L(e,t){var r=R.length,n=e.constructor,i=g.isFunction(n)&&n.prototype||s,a="constructor";for(g.has(e,a)&&!g.contains(t,a)&&t.push(a);r--;)(a=R[r])in e&&e[a]!==i[a]&&!g.contains(t,a)&&t.push(a)}g.keys=function(e){if(!g.isObject(e))return[];if(h)return h(e);var t=[];for(var r in e)g.has(e,r)&&t.push(r);return N&&L(e,t),t},g.allKeys=function(e){if(!g.isObject(e))return[];var t=[];for(var r in e)t.push(r);return N&&L(e,t),t},g.values=function(e){for(var t=g.keys(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n},g.mapObject=function(e,t,r){t=m(t,r);for(var n,i=g.keys(e),s=i.length,a={},o=0;o<s;o++)a[n=i[o]]=t(e[n],n,e);return a},g.pairs=function(e){for(var t=g.keys(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=[t[i],e[t[i]]];return n},g.invert=function(e){for(var t={},r=g.keys(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t},g.functions=g.methods=function(e){var t=[];for(var r in e)g.isFunction(e[r])&&t.push(r);return t.sort()},g.extend=b(g.allKeys),g.extendOwn=g.assign=b(g.keys),g.findKey=function(e,t,r){t=m(t,r);for(var n,i=g.keys(e),s=0,a=i.length;s<a;s++)if(t(e[n=i[s]],n,e))return n},g.pick=function(e,t,r){var n,i,s={},a=e;if(null==a)return s;g.isFunction(t)?(i=g.allKeys(a),n=y(t,r)):(i=O(arguments,!1,!1,1),n=function(e,t,r){return t in r},a=Object(a));for(var o=0,u=i.length;o<u;o++){var c=i[o],l=a[c];n(l,c,a)&&(s[c]=l)}return s},g.omit=function(e,t,r){if(g.isFunction(t))t=g.negate(t);else{var n=g.map(O(arguments,!1,!1,1),String);t=function(e,t){return!g.contains(n,t)}}return g.pick(e,t,r)},g.defaults=b(g.allKeys,!0),g.create=function(e,t){var r=_(e);return t&&g.extendOwn(r,t),r},g.clone=function(e){return g.isObject(e)?g.isArray(e)?e.slice():g.extend({},e):e},g.tap=function(e,t){return t(e),e},g.isMatch=function(e,t){var r=g.keys(t),n=r.length;if(null==e)return!n;for(var i=Object(e),s=0;s<n;s++){var a=r[s];if(t[a]!==i[a]||!(a in i))return!1}return!0};var C=function(e,t,r,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof g&&(e=e._wrapped),t instanceof g&&(t=t._wrapped);var i=c.call(e);if(i!==c.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var s="[object Array]"===i;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var a=e.constructor,o=t.constructor;if(a!==o&&!(g.isFunction(a)&&a instanceof a&&g.isFunction(o)&&o instanceof o)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),s){if((u=e.length)!==t.length)return!1;for(;u--;)if(!C(e[u],t[u],r,n))return!1}else{var l,f=g.keys(e);if(u=f.length,g.keys(t).length!==u)return!1;for(;u--;)if(l=f[u],!g.has(t,l)||!C(e[l],t[l],r,n))return!1}return r.pop(),n.pop(),!0};g.isEqual=function(e,t){return C(e,t)},g.isEmpty=function(e){return null==e||(E(e)&&(g.isArray(e)||g.isString(e)||g.isArguments(e))?0===e.length:0===g.keys(e).length)},g.isElement=function(e){return!(!e||1!==e.nodeType)},g.isArray=f||function(e){return"[object Array]"===c.call(e)},g.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},g.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){g["is"+e]=function(t){return c.call(t)==="[object "+e+"]"}}),g.isArguments(arguments)||(g.isArguments=function(e){return g.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(g.isFunction=function(e){return"function"==typeof e||!1}),g.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},g.isNaN=function(e){return g.isNumber(e)&&e!==+e},g.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===c.call(e)},g.isNull=function(e){return null===e},g.isUndefined=function(e){return void 0===e},g.has=function(e,t){return null!=e&&l.call(e,t)},g.noConflict=function(){return e._=n,this},g.identity=function(e){return e},g.constant=function(e){return function(){return e}},g.noop=function(){},g.property=x,g.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},g.matcher=g.matches=function(e){return e=g.extendOwn({},e),function(t){return g.isMatch(t,e)}},g.times=function(e,t,r){var n=Array(Math.max(0,e));t=y(t,r,1);for(var i=0;i<e;i++)n[i]=t(i);return n},g.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},g.now=Date.now||function(){return(new Date).getTime()};var B={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},M=g.invert(B),P=function(e){var t=function(t){return e[t]},r="(?:"+g.keys(e).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(i,t):e}};g.escape=P(B),g.unescape=P(M),g.result=function(e,t,r){var n=null==e?void 0:e[t];return void 0===n&&(n=r),g.isFunction(n)?n.call(e):n};var F=0;g.uniqueId=function(e){var t=++F+"";return e?e+t:t},g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var U=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},q=/\\|'|\r|\n|\u2028|\u2029/g,z=function(e){return"\\"+D[e]};g.template=function(e,t,r){!t&&r&&(t=r),t=g.defaults({},t,g.templateSettings);var n=RegExp([(t.escape||U).source,(t.interpolate||U).source,(t.evaluate||U).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(n,function(t,r,n,a,o){return s+=e.slice(i,o).replace(q,z),i=o+t.length,r?s+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":a&&(s+="';\n"+a+"\n__p+='"),t}),s+="';\n",t.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var a=new Function(t.variable||"obj","_",s)}catch(e){throw e.source=s,e}var o=function(e){return a.call(this,e,g)},u=t.variable||"obj";return o.source="function("+u+"){\n"+s+"}",o},g.chain=function(e){var t=g(e);return t._chain=!0,t};var V=function(e,t){return e._chain?g(t).chain():t};g.mixin=function(e){g.each(g.functions(e),function(t){var r=g[t]=e[t];g.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),V(this,r.apply(g,e))}})},g.mixin(g),g.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];g.prototype[e]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==e&&"splice"!==e||0!==r.length||delete r[0],V(this,r)}}),g.each(["concat","join","slice"],function(e){var t=i[e];g.prototype[e]=function(){return V(this,t.apply(this._wrapped,arguments))}}),g.prototype.value=function(){return this._wrapped},g.prototype.valueOf=g.prototype.toJSON=g.prototype.value,g.prototype.toString=function(){return""+this._wrapped}}).call(this)},{}],6:[function(e,t,r){var n=function(){var t=e("@shexjs/core"),r=t.RdfTerm,n=t.Util,i=e("@shexjs/core").Validator,s=e("./lib/extensions"),a=e("n3"),o=e("underscore"),u="http://shex.io/extensions/Map/#",c=/^ *(?:<([^>]*)>|([^:]*):([^ ]*)) *$/,l=-1;const f=50;function h(e){if("object"!=typeof e)return e;var t='"'+e.value+'"';return"language"in e?t+"@"+e.language:"type"in e?t+"^^"+e.type:t}function p(e,t){var r,n,i,s=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(e);return s&&(n=t[r=s[1]],i=s.index),void 0===n?e:0===i?n+e.substr(r.length+1):e.substr(0,i+3)+n+e.substr(i+r.length+4)}function d(e,t,n,i,d,v,g,y,m,b){function _(e,t,n){return i.addQuad(r.externalTriple({subject:e,predicate:t,object:h(n)},a.DataFactory)),e}var x=(e.semActs||[]).filter(function(e){return e.name===u});if(x.length)x.forEach(function(r){var n,i=r.code,a=i.match(c);if(a){var u=a[1]?a[1]:p(a[2]+":"+a[3],v.prefixes),l=g.get(u);o.isUndefined(l)||(n=l)}o.isUndefined(n)&&/[ a-zA-Z0-9]+\(/.test(i)&&(n=s.lower(i,g,v.prefixes)),o.isUndefined(n)||(e.inverse?_(n,e.predicate,t.cs):_(t.cs,e.predicate,n))});else if("values"in e.valueExpr&&1===e.valueExpr.values.length)e.inverse?_(e.valueExpr.values[0],e.predicate,t.cs):_(t.cs,e.predicate,e.valueExpr.values[0]);else{var w=t.cs,S="max"in e?e.max===l?1/0:e.max:1;S>f&&(S=f),y||(S=1);for(var E=0;E<S;++E){if(t.cs=n(),y)if("errors"in b(t.cs,e.valueExpr,y,m))break;e.inverse?_(t.cs,e.predicate,w):_(w,e.predicate,t.cs)}d._maybeSet(e,{type:"TripleConstraint"},"TripleConstraint",["inverse","negated","predicate","valueExpr","min","max","annotations","semActs"]),t.cs=w}}return{register:function(e){var t="prefixes"in e.schema?e.schema.prefixes:{};return e.semActHandler.results[u]={},e.semActHandler.register(u,{dispatch:function(r,n,i){function a(e){var t=Error(e);throw Error.captureStackTrace(t,a),t}var l=function(n,s){if(!n)throw Error("Invocation error: "+u+' code "'+r+"\" didn't match "+c);var l=function(e){return o.isString(e)?e:e[1]?e[1]:e[2]in t?t[e[2]]+e[3]:a("unknown prefix "+e[2]+' in "'+r+'".')}(n),f=s;e.semActHandler.results[u][l]=f,i[l]=f};if(/.*[(].*[)].*$/.test(r)){var f=s.lift(r,n.object,t);o.mapObject(f,function(e,t){l(t,e)})}else{var h=r.match(c);l(h,n.object)}return!0}}),e.semActHandler.results[u]},done:function(e){0===Object.keys(e.semActHandler.results[u]).length&&delete e.semActHandler.results[u]},materializer:function(e,t){var r=0;return t=t||function(){return"_:b"+r++},{materialize:function(r,s,o,u){o=o&&o!==i.start?{type:"ShapeRef",reference:o}:e.start,u=u||new a.Store;var c={cs:s||t()},l=n.Visitor(),f=l.visitShapeRef;return l.visitShapeRef=function(t){return this.visitShapeExpr(e.shapes[t.reference],t.reference),f.call(l,t)},l.visitValueRef=function(t){return this.visitExpression(e.shapes[t.reference],t.reference),this._visitValue(t)},l.visitTripleConstraint=function(n){d(n,c,t,u,this,e,r)},l.visitShapeExpr(o,"_: -start-"),u}}},binder:function(e){var t=[],r={};return function e(t){var r,n=[],i=[],s=Object.keys(t).reduce((s,a)=>{var o=null;return"object"==typeof t[a]?(o=e(t[a]),t[a].constructor===Array?n.push(a):i.push(a)):((r={})[a]=1,o=r),function(e,t){var r=Object.assign({},e);return Object.keys(t).reduce((e,r)=>{var n=r in t?t[r]:1;return e[r]=r in e?e[r]+n:n,e},r)}(s,o)},{});return n.length>0&&(i.forEach(e=>{var r=Object.keys(t[e]).filter(e=>1===s[e]);if(r.length){var i=r.reduce((r,n)=>(r[n]=t[e][n],r),{});n.forEach(e=>{!function e(t,r){for(var n in t)t[n].constructor===Array?e(t[n],r):Object.keys(r).forEach(e=>{if(e in t[n])throw Error("unexpected duplicate key: "+e+" in "+JSON.stringify(t[n]));t[n][e]=r[e]})}(t[e],i)})}}),i.reverse(),i.forEach(e=>{t.splice(e,1)})),s}(e),e=e.constructor===Array?function e(t){var r=t.reduce((t,r)=>t.concat(r.constructor===Array?e(r):r),[]);return 1===r.length?r[0]:r}(e):[e],{get:function(n){if(null!==t){if(n in r)return r[n];for(var i=t.slice(),s=c(i);!(n in s);){for(var a;s.constructor!==Array;)a=i.pop(),s=u(i);if(s.length===a+1)return void(t=null);i.push(a+1),s=c(i)}t=i.slice();var o=s[n];return delete s[n],o}function u(t){return t.reduce(function(e,t){return e[t]},e)}function c(e){for(;u(e).constructor===Array;)e.push(0);return u(e)}}}},url:u,visitTripleConstraint:d}}();n.extension={hashmap:e("./lib/hashmap_extension.js"),regex:e("./lib/regex_extension.js")},n.extensions=e("./lib/extensions.js"),n.utils=e("./lib/extension-utils.js"),void 0!==e&&void 0!==r&&(t.exports=n)},{"./lib/extension-utils.js":1,"./lib/extensions":2,"./lib/extensions.js":2,"./lib/hashmap_extension.js":3,"./lib/regex_extension.js":4,"@shexjs/core":55,n3:16,underscore:5}],7:[function(e,t,r){"use strict";r.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n},r.toByteArray=function(e){for(var t,r=c(e),n=r[0],a=r[1],o=new s(function(e,t,r){return 3*(t+r)/4-r}(0,n,a)),u=0,l=a>0?n-4:n,f=0;f<l;f+=4)t=i[e.charCodeAt(f)]<<18|i[e.charCodeAt(f+1)]<<12|i[e.charCodeAt(f+2)]<<6|i[e.charCodeAt(f+3)],o[u++]=t>>16&255,o[u++]=t>>8&255,o[u++]=255&t;2===a&&(t=i[e.charCodeAt(f)]<<2|i[e.charCodeAt(f+1)]>>4,o[u++]=255&t);1===a&&(t=i[e.charCodeAt(f)]<<10|i[e.charCodeAt(f+1)]<<4|i[e.charCodeAt(f+2)]>>2,o[u++]=t>>8&255,o[u++]=255&t);return o},r.fromByteArray=function(e){for(var t,r=e.length,i=r%3,s=[],a=0,o=r-i;a<o;a+=16383)s.push(l(e,a,a+16383>o?o:a+16383));1===i?(t=e[r-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return s.join("")};for(var n=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,u=a.length;o<u;++o)n[o]=a[o],i[a.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e,t,r){for(var i,s,a=[],o=t;o<r;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(n[(s=i)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],8:[function(e,t,r){},{}],9:[function(e,t,r){(function(t){"use strict";var n=e("base64-js"),i=e("ieee754");r.Buffer=t,r.SlowBuffer=function(e){+e!=e&&(e=0);return t.alloc(+e)},r.INSPECT_MAX_BYTES=50;var s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');var r=new Uint8Array(e);return r.__proto__=t.prototype,r}function t(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return o(e,t,r)}function o(e,r,n){if("string"==typeof e)return function(e,r){"string"==typeof r&&""!==r||(r="utf8");if(!t.isEncoding(r))throw new TypeError("Unknown encoding: "+r);var n=0|h(e,r),i=a(n),s=i.write(e,r);s!==n&&(i=i.slice(0,s));return i}(e,r);if(ArrayBuffer.isView(e))return l(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(U(e,ArrayBuffer)||e&&U(e.buffer,ArrayBuffer))return function(e,r,n){if(r<0||e.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<r+(n||0))throw new RangeError('"length" is outside of buffer bounds');var i;i=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);return i.__proto__=t.prototype,i}(e,r,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return t.from(i,r,n);var s=function(e){if(t.isBuffer(e)){var r=0|f(e.length),n=a(r);return 0===n.length?n:(e.copy(n,0,0,r),n)}if(void 0!==e.length)return"number"!=typeof e.length||D(e.length)?a(0):l(e);if("Buffer"===e.type&&Array.isArray(e.data))return l(e.data)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return t.from(e[Symbol.toPrimitive]("string"),r,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return u(e),a(e<0?0:0|f(e))}function l(e){for(var t=e.length<0?0:0|f(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function h(e,r){if(t.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||U(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;for(var s=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return M(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return P(e).length;default:if(s)return i?-1:M(e).length;r=(""+r).toLowerCase(),s=!0}}function p(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function d(e,r,n,i,s){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),D(n=+n)&&(n=s?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}if("string"==typeof r&&(r=t.from(r,i)),t.isBuffer(r))return 0===r.length?-1:v(e,r,n,i,s);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,r,n):Uint8Array.prototype.lastIndexOf.call(e,r,n):v(e,[r],n,i,s);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){var s,a=1,o=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,o/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(s=r;s<o;s++)if(c(e,s)===c(t,-1===l?0:s-l)){if(-1===l&&(l=s),s-l+1===u)return l*a}else-1!==l&&(s-=s-l),l=-1}else for(r+u>o&&(r=o-u),s=r;s>=0;s--){for(var f=!0,h=0;h<u;h++)if(c(e,s+h)!==c(t,h)){f=!1;break}if(f)return s}return-1}function g(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=t.length;n>s/2&&(n=s/2);for(var a=0;a<n;++a){var o=parseInt(t.substr(2*a,2),16);if(D(o))return a;e[r+a]=o}return a}function y(e,t,r,n){return F(M(t,e.length-r),e,r,n)}function m(e,t,r,n){return F(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function b(e,t,r,n){return m(e,t,r,n)}function _(e,t,r,n){return F(P(t),e,r,n)}function x(e,t,r,n){return F(function(e,t){for(var r,n,i,s=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function w(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function S(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var s,a,o,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=r)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(s=e[i+1]))&&(u=(31&c)<<6|63&s)>127&&(l=u);break;case 3:s=e[i+1],a=e[i+2],128==(192&s)&&128==(192&a)&&(u=(15&c)<<12|(63&s)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:s=e[i+1],a=e[i+2],o=e[i+3],128==(192&s)&&128==(192&a)&&128==(192&o)&&(u=(15&c)<<18|(63&s)<<12|(63&a)<<6|63&o)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(e){var t=e.length;if(t<=E)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=E));return r}(n)}r.kMaxLength=s,t.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),t.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.buffer}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),t.poolSize=8192,t.from=function(e,t,r){return o(e,t,r)},t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array,t.alloc=function(e,t,r){return function(e,t,r){return u(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},t.allocUnsafe=function(e){return c(e)},t.allocUnsafeSlow=function(e){return c(e)},t.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==t.prototype},t.compare=function(e,r){if(U(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),U(r,Uint8Array)&&(r=t.from(r,r.offset,r.byteLength)),!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var n=e.length,i=r.length,s=0,a=Math.min(n,i);s<a;++s)if(e[s]!==r[s]){n=e[s],i=r[s];break}return n<i?-1:i<n?1:0},t.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return t.alloc(0);var n;if(void 0===r)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var i=t.allocUnsafe(r),s=0;for(n=0;n<e.length;++n){var a=e[n];if(U(a,Uint8Array)&&(a=t.from(a)),!t.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,s),s+=a.length}return i},t.byteLength=h,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},t.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},t.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},t.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return j(this,t,r);case"latin1":case"binary":return k(this,t,r);case"base64":return w(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},t.prototype.toLocaleString=t.prototype.toString,t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===t.compare(this,e)},t.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},t.prototype.compare=function(e,r,n,i,s){if(U(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),!t.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===s&&(s=this.length),r<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&r>=n)return 0;if(i>=s)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;for(var a=s-i,o=n-r,u=Math.min(a,o),c=this.slice(i,s),l=e.slice(r,n),f=0;f<u;++f)if(c[f]!==l[f]){a=c[f],o=l[f];break}return a<o?-1:o<a?1:0},t.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},t.prototype.indexOf=function(e,t,r){return d(this,e,t,r,!0)},t.prototype.lastIndexOf=function(e,t,r){return d(this,e,t,r,!1)},t.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return g(this,e,t,r);case"utf8":case"utf-8":return y(this,e,t,r);case"ascii":return m(this,e,t,r);case"latin1":case"binary":return b(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function j(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function k(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function O(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=t;s<r;++s)i+=B(e[s]);return i}function I(e,t,r){for(var n=e.slice(t,r),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function T(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function A(e,r,n,i,s,a){if(!t.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>s||r<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function N(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function R(e,t,r,n,s){return t=+t,r>>>=0,s||N(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function L(e,t,r,n,s){return t=+t,r>>>=0,s||N(e,0,r,8),i.write(e,t,r,n,52,8),r+8}t.prototype.slice=function(e,r){var n=this.length;e=~~e,r=void 0===r?n:~~r,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),r<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<e&&(r=e);var i=this.subarray(e,r);return i.__proto__=t.prototype,i},t.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n},t.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},t.prototype.readUInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),this[e]},t.prototype.readUInt16LE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]|this[e+1]<<8},t.prototype.readUInt16BE=function(e,t){return e>>>=0,t||T(e,2,this.length),this[e]<<8|this[e+1]},t.prototype.readUInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},t.prototype.readUInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},t.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},t.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||T(e,t,this.length);for(var n=t,i=1,s=this[e+--n];n>0&&(i*=256);)s+=this[e+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},t.prototype.readInt8=function(e,t){return e>>>=0,t||T(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},t.prototype.readInt16LE=function(e,t){e>>>=0,t||T(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt16BE=function(e,t){e>>>=0,t||T(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},t.prototype.readInt32LE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},t.prototype.readInt32BE=function(e,t){return e>>>=0,t||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},t.prototype.readFloatLE=function(e,t){return e>>>=0,t||T(e,4,this.length),i.read(this,e,!0,23,4)},t.prototype.readFloatBE=function(e,t){return e>>>=0,t||T(e,4,this.length),i.read(this,e,!1,23,4)},t.prototype.readDoubleLE=function(e,t){return e>>>=0,t||T(e,8,this.length),i.read(this,e,!0,52,8)},t.prototype.readDoubleBE=function(e,t){return e>>>=0,t||T(e,8,this.length),i.read(this,e,!1,52,8)},t.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||A(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},t.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||A(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},t.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,255,0),this[t]=255&e,t+1},t.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},t.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);A(this,e,t,r,i-1,-i)}var s=0,a=1,o=0;for(this[t]=255&e;++s<r&&(a*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/a>>0)-o&255;return t+r},t.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);A(this,e,t,r,i-1,-i)}var s=r-1,a=1,o=0;for(this[t+s]=255&e;--s>=0&&(a*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/a>>0)-o&255;return t+r},t.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},t.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},t.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeFloatLE=function(e,t,r){return R(this,e,t,!0,r)},t.prototype.writeFloatBE=function(e,t,r){return R(this,e,t,!1,r)},t.prototype.writeDoubleLE=function(e,t,r){return L(this,e,t,!0,r)},t.prototype.writeDoubleBE=function(e,t,r){return L(this,e,t,!1,r)},t.prototype.copy=function(e,r,n,i){if(!t.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var s=i-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,n,i);else if(this===e&&n<r&&r<i)for(var a=s-1;a>=0;--a)e[a+r]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,i),r);return s},t.prototype.fill=function(e,r,n,i){if("string"==typeof e){if("string"==typeof r?(i=r,r=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!t.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){var s=e.charCodeAt(0);("utf8"===i&&s<128||"latin1"===i)&&(e=s)}}else"number"==typeof e&&(e&=255);if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;var a;if(r>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=r;a<n;++a)this[a]=e;else{var o=t.isBuffer(e)?e:t.from(e,i),u=o.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<n-r;++a)this[a+r]=o[a%u]}return this};var C=/[^+/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function M(e,t){var r;t=t||1/0;for(var n=e.length,i=null,s=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function P(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(C,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function U(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function D(e){return e!=e}}).call(this,e("buffer").Buffer)},{"base64-js":7,buffer:9,ieee754:12}],10:[function(e,t,r){(function(e){function t(e){return Object.prototype.toString.call(e)}r.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},r.isBoolean=function(e){return"boolean"==typeof e},r.isNull=function(e){return null===e},r.isNullOrUndefined=function(e){return null==e},r.isNumber=function(e){return"number"==typeof e},r.isString=function(e){return"string"==typeof e},r.isSymbol=function(e){return"symbol"==typeof e},r.isUndefined=function(e){return void 0===e},r.isRegExp=function(e){return"[object RegExp]"===t(e)},r.isObject=function(e){return"object"==typeof e&&null!==e},r.isDate=function(e){return"[object Date]"===t(e)},r.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},r.isFunction=function(e){return"function"==typeof e},r.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},r.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":14}],11:[function(e,t,r){var n=Object.create||function(e){var t=function(){};return t.prototype=e,new t},i=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return r},s=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function a(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=n(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0;var o,u=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),o=0===c.x}catch(e){o=!1}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function f(e,t,r,i){var s,a,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((a=e._events)?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),o=a[t]):(a=e._events=n(null),e._eventsCount=0),o){if("function"==typeof o?o=a[t]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),!o.warned&&(s=l(e))&&s>0&&o.length>s){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",u.name,u.message)}}else o=a[t]=r,++e._eventsCount;return e}function h(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function p(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=s.call(h,n);return i.listener=r,n.wrapFn=i,i}function d(e,t,r){var n=e._events;if(!n)return[];var i=n[t];return i?"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):g(i,i.length):[]}function v(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function g(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}o?Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');u=e}}):a.defaultMaxListeners=u,a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){var t,r,n,i,s,a,o="error"===e;if(a=this._events)o=o&&null==a.error;else if(!o)return!1;if(o){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var u=new Error('Unhandled "error" event. ('+t+")");throw u.context=t,u}if(!(r=a[e]))return!1;var c="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,i=g(e,n),s=0;s<n;++s)i[s].call(r)}(r,c,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,s=g(e,i),a=0;a<i;++a)s[a].call(r,n)}(r,c,this,arguments[1]);break;case 3:!function(e,t,r,n,i){if(t)e.call(r,n,i);else for(var s=e.length,a=g(e,s),o=0;o<s;++o)a[o].call(r,n,i)}(r,c,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,i,s){if(t)e.call(r,n,i,s);else for(var a=e.length,o=g(e,a),u=0;u<a;++u)o[u].call(r,n,i,s)}(r,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),s=1;s<n;s++)i[s-1]=arguments[s];!function(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,s=g(e,i),a=0;a<i;++a)s[a].apply(r,n)}(r,c,this,i)}return!0},a.prototype.addListener=function(e,t){return f(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return f(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,p(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,p(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,i,s,a,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=n(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){o=r[a].listener,s=a;break}if(s<0)return this;0===s?r.shift():function(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(r,s),1===r.length&&(i[e]=r[0]),i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.removeAllListeners=function(e){var t,r,s;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=n(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=n(null):delete r[e]),this;if(0===arguments.length){var a,o=i(r);for(s=0;s<o.length;++s)"removeListener"!==(a=o[s])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=n(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},a.prototype.listenerCount=v,a.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],12:[function(e,t,r){r.read=function(e,t,r,n,i){var s,a,o=8*i-n-1,u=(1<<o)-1,c=u>>1,l=-7,f=r?i-1:0,h=r?-1:1,p=e[t+f];for(f+=h,s=p&(1<<-l)-1,p>>=-l,l+=o;l>0;s=256*s+e[t+f],f+=h,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=h,l-=8);if(0===s)s=1-c;else{if(s===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),s-=c}return(p?-1:1)*a*Math.pow(2,s-n)},r.write=function(e,t,r,n,i,s){var a,o,u,c=8*s-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,d=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(o=0,a=l):a+f>=1?(o=(t*u-1)*Math.pow(2,i),a+=f):(o=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[r+p]=255&o,p+=d,o/=256,i-=8);for(a=a<<i|o,c+=i;c>0;e[r+p]=255&a,p+=d,a/=256,c-=8);e[r+p-d]|=128*v}},{}],13:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],14:[function(e,t,r){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},{}],15:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],16:[function(e,t,r){t.exports={DataFactory:e("./lib/N3DataFactory"),Lexer:e("./lib/N3Lexer"),Parser:e("./lib/N3Parser"),Writer:e("./lib/N3Writer"),Store:e("./lib/N3Store"),StreamParser:e("./lib/N3StreamParser"),StreamWriter:e("./lib/N3StreamWriter"),Util:e("./lib/N3Util")}},{"./lib/N3DataFactory":18,"./lib/N3Lexer":19,"./lib/N3Parser":20,"./lib/N3Store":21,"./lib/N3StreamParser":22,"./lib/N3StreamWriter":23,"./lib/N3Util":24,"./lib/N3Writer":25}],17:[function(e,t,r){var n="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#",s="http://www.w3.org/2000/10/swap/";t.exports={xsd:{decimal:i+"decimal",boolean:i+"boolean",double:i+"double",integer:i+"integer",string:i+"string"},rdf:{type:n+"type",nil:n+"nil",first:n+"first",rest:n+"rest",langString:n+"langString"},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:s+"reify#forSome",forAll:s+"reify#forAll"},log:{implies:s+"log#implies"}}},{}],18:[function(e,t,r){var n,i,s=e("./IRIs"),a=s.rdf,o=s.xsd,u=0;class c{constructor(e){this.id=e}get termType(){return this.constructor.name}get value(){return this.id}equals(e){return e instanceof c?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}toJSON(){return{termType:this.termType,value:this.value}}}class l extends c{}l.name="NamedNode";class f extends c{get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){var e=this.id,t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new l(this.datatypeString)}get datatypeString(){var e,t=this.id,r=t.lastIndexOf('"')+1;return r<t.length&&"^"===(e=t[r])?t.substr(r+2):"@"!==e?o.string:a.langString}equals(e){return e instanceof f?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}f.name="Literal";class h extends c{constructor(e){super("_:"+e)}get value(){return this.id.substr(2)}}h.name="BlankNode";class p extends c{constructor(e){super("?"+e)}get value(){return this.id.substr(1)}}p.name="Variable";class d extends c{constructor(){return super(""),i||this}equals(e){return this===e||!!e&&this.termType===e.termType}}d.name="DefaultGraph",i=new d;class v{constructor(e,t,r,n){this.subject=e,this.predicate=t,this.object=r,this.graph=n||i}toJSON(){return{subject:this.subject.toJSON(),predicate:this.predicate.toJSON(),object:this.object.toJSON(),graph:this.graph.toJSON()}}equals(e){return!!e&&this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)&&this.graph.equals(e.graph)}}function g(e,t,r,n){return new v(e,t,r,n)}t.exports=n={namedNode:function(e){return new l(e)},blankNode:function(e){return e||(e="n3-"+u++),new h(e)},variable:function(e){return new p(e)},literal:function(e,t){if("string"==typeof t)return new f('"'+e+'"@'+t.toLowerCase());var r=t&&t.value||"";if(!r)switch(typeof e){case"boolean":r=o.boolean;break;case"number":Number.isFinite(e)?r=Number.isInteger(e)?o.integer:o.double:(r=o.double,Number.isNaN(e)||(e=e>0?"INF":"-INF"));break;default:return new f('"'+e+'"')}return new f('"'+e+'"^^'+r)},defaultGraph:function(){return i},quad:g,triple:g,internal:{Term:c,NamedNode:l,BlankNode:h,Variable:p,Literal:f,DefaultGraph:d,Quad:v,Triple:v,fromId:function(e,t){if(t=t||n,!e)return t.defaultGraph();switch(e[0]){case"_":return t.blankNode(e.substr(2));case"?":return t.variable(e.substr(1));case'"':if(t===n)return new f(e);if('"'===e[e.length-1])return t.literal(e.substr(1,e.length-2));var r=e.lastIndexOf('"',e.length-1);return t.literal(e.substr(1,r-1),"@"===e[r+1]?e.substr(r+2):t.namedNode(e.substr(r+3)));default:return t.namedNode(e)}},toId:function(e){if("string"==typeof e)return e;if(e instanceof c)return e.id;if(!e)return i.id;switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return"_:"+e.value;case"Variable":return"?"+e.value;case"DefaultGraph":return"";case"Literal":return'"'+e.value+'"'+(e.language?"@"+e.language:e.datatype&&e.datatype.value!==o.string?"^^"+e.datatype.value:"");default:throw new Error("Unexpected termType: "+e.termType)}}}}},{"./IRIs":17}],19:[function(e,t,r){(function(r,n){var i=e("./IRIs").xsd,s=String.fromCharCode,a="function"==typeof n?n:function(e){setTimeout(e,0)},o=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,u={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},c=/[\x00-\x20<>\\"\{\}\|\^\`]/,l={_iri:!0,_unescapedIri:!0,_unescapedQuote:!0,_singleQuote:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},f=/$0^/;t.exports=class{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._unescapedQuote=/^"([^"\\\r\n]+)"/,this._unescapedApos=/^'([^'\\\r\n]+)'/,this._singleQuote=/^"((?:[^"\\\r\n]|\\.)*)"(?=[^"])/,this._singleApos=/^'((?:[^'\\\r\n]|\\.)*)'(?=[^'])/,this._tripleQuote=/^"""([^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*)"""/,this._tripleApos=/^'''([^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*)'''/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<]))/,this._number=/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=\.?[,;:\s#()\[\]\{\}"'<])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s()\[\]\{\}"'<])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode)for(var t in this._n3Mode=!1,this)!(t in l)&&this[t]instanceof RegExp&&(this[t]=f);else this._n3Mode=!1!==e.n3;this._comments=!!e.comments}_tokenizeToEnd(e,t){for(var r=this._input,n=this._comments;;){for(var s,a;s=this._newline.exec(r);)n&&(a=this._comment.exec(s[0]))&&e(null,{line:this._line,type:"comment",value:a[1],prefix:""}),r=r.substr(s[0].length,r.length),this._line++;if((s=this._whitespace.exec(r))&&(r=r.substr(s[0].length,r.length)),this._endOfFile.test(r))return t&&(n&&(a=this._comment.exec(r))&&e(null,{line:this._line,type:"comment",value:a[1],prefix:""}),e(r=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=r;var o=this._line,u="",l="",f="",h=r[0],p=null,d=0,v=!1;switch(h){case"^":if(r.length<3)break;if("^"!==r[1]){this._n3Mode&&(d=1,u="^");break}if(this._previousMarker="^^","<"!==(r=r.substr(2))[0]){v=!0;break}case"<":if(p=this._unescapedIri.exec(r))u="IRI",l=p[1];else if(p=this._iri.exec(r)){if(null===(l=this._unescape(p[1]))||c.test(l))return y(this);u="IRI"}else this._n3Mode&&r.length>1&&"="===r[1]&&(u="inverse",d=2,l=">");break;case"_":((p=this._blank.exec(r))||t&&(p=this._blank.exec(r+" ")))&&(u="blank",f="_",l=p[1]);break;case'"':if(p=this._unescapedQuote.exec(r))l=p[1];else if(r.indexOf('"',1)>0&&((p=this._singleQuote.exec(r))?l=this._unescape(p[1]):(p=this._tripleQuote.exec(r))&&(l=p[1],this._line+=l.split(/\r\n|\r|\n/).length-1,l=this._unescape(l)),null===l))return y(this);null!==p&&(u="literal");break;case"'":if(p=this._unescapedApos.exec(r))l=p[1];else if(r.indexOf("'",1)>0&&((p=this._singleApos.exec(r))?l=this._unescape(p[1]):(p=this._tripleApos.exec(r))&&(l=p[1],this._line+=l.split(/\r\n|\r|\n/).length-1,l=this._unescape(l)),null===l))return y(this);null!==p&&(u="literal");break;case"?":this._n3Mode&&(p=this._variable.exec(r))&&(u="var",l=p[0]);break;case"@":"literal"===this._previousMarker&&(p=this._langcode.exec(r))?(u="langcode",l=p[1]):(p=this._keyword.exec(r))&&(u=p[0]);break;case".":if(1===r.length?t:r[1]<"0"||r[1]>"9"){u=".",d=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(p=this._number.exec(r)||t&&(p=this._number.exec(r+" ")))&&(u="literal",l=p[0],f=p[1]?i.double:/^[+\-]?\d+$/.test(p[0])?i.integer:i.decimal);break;case"B":case"b":case"p":case"P":case"G":case"g":(p=this._sparqlKeyword.exec(r))?u=p[0].toUpperCase():v=!0;break;case"f":case"t":(p=this._boolean.exec(r))?(u="literal",l=p[0],f=i.boolean):v=!0;break;case"a":(p=this._shortPredicates.exec(r))?(u="abbreviation",l="a"):v=!0;break;case"=":this._n3Mode&&r.length>1&&(u="abbreviation",">"!==r[1]?(d=1,l="="):(d=2,l=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(d=1,u=h);break;default:v=!0}if(v&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(p=this._prefix.exec(r))?((p=this._prefixed.exec(r))||t&&(p=this._prefixed.exec(r+" ")))&&(u="prefixed",f=p[1]||"",l=this._unescape(p[2])):(u="prefix",l=p[1]||"")),"^^"===this._previousMarker)switch(u){case"prefixed":u="type";break;case"IRI":u="typeIRI";break;default:u=""}if(!u)return t||!/^'''|^"""/.test(r)&&/\n|\r/.test(r)?y(this):this._input=r;var g={line:o,type:u,value:l,prefix:f};e(null,g),this.previousToken=g,this._previousMarker=u,r=r.substr(d||p[0].length,r.length)}function y(t){e(t._syntaxError(/^\S*/.exec(r)[0]))}}_unescape(e){try{return e.replace(o,function(e,t,r,n){var i;if(t){if(i=parseInt(t,16),isNaN(i))throw new Error;return s(i)}if(r){if(i=parseInt(r,16),isNaN(i))throw new Error;return i<=65535?s(i):s(55296+(i-=65536)/1024,56320+(1023&i))}var a=u[n];if(!a)throw new Error;return a})}catch(e){return null}}_syntaxError(e){this._input=null;var t=new Error('Unexpected "'+e+'" on line '+this._line+".");return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}tokenize(e,t){var n=this;if(this._line=1,"string"==typeof e){if(this._input=e,"function"!=typeof t){var i,s=[];if(this._tokenizeToEnd(function(e,t){e?i=e:s.push(t)},!0),i)throw i;return s}a(function(){n._tokenizeToEnd(t,!0)})}else this._input="",this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",function(e){null!==n._input&&0!==e.length&&(n._pendingBuffer&&(e=r.concat([n._pendingBuffer,e]),n._pendingBuffer=null),128&e[e.length-1]?n._pendingBuffer=e:(n._input+=e,n._tokenizeToEnd(t,!1)))}),e.on("end",function(){null!==n._input&&n._tokenizeToEnd(t,!0)}),e.on("error",t)}}}).call(this,e("buffer").Buffer,e("timers").setImmediate)},{"./IRIs":17,buffer:9,timers:44}],20:[function(e,t,r){var n=e("./N3Lexer"),i=e("./N3DataFactory"),s=e("./IRIs"),a=0,o=0;class u{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&l(this,e.factory);var t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",r="turtle"===t,i="trig"===t,s=/triple/.test(t),a=/quad/.test(t),o=this._n3Mode=/n3/.test(t),u=s||a;(this._supportsNamedGraphs=!(r||o))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||i||s||o),u&&(this._resolveRelativeIRI=function(e){return""}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new n({lineMode:u,n3:o}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodeIds(){a=o=0}_blank(){return this._blankNode("b"+o++)}_setBase(e){if(e){var t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base=null}_saveContext(e,t,r,n,i){var s=this._n3Mode;this._contextStack.push({subject:r,predicate:n,object:i,graph:t,type:e,inverse:!!s&&this._inversePredicate,blankPrefix:s?this._prefixes._:"",quantified:s?this._quantified:null}),s&&(this._inversePredicate=!1,this._prefixes._=this._graph?this._graph.id.substr(2)+".":".",this._quantified=Object.create(this._quantified))}_restoreContext(){var e=this._contextStack.pop(),t=this._n3Mode;this._subject=e.subject,this._predicate=e.predicate,this._object=e.object,this._graph=e.graph,t&&(this._inversePredicate=e.inverse,this._prefixes._=e.blankPrefix,this._quantified=e.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){var r;switch(e.type){case"IRI":case"typeIRI":var n=this._resolveIRI(e.value);if(""===n)return this._error("Invalid IRI",e);r=this._namedNode(n);break;case"type":case"prefixed":var i=this._prefixes[e.prefix];if(void 0===i)return this._error('Undefined prefix "'+e.prefix+':"',e);r=this._namedNode(i+e.value);break;case"blank":r=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":r=this._variable(e.value.substr(1));break;default:return this._error("Expected entity but got "+e.type,e)}return!t&&this._n3Mode&&r.id in this._quantified&&(r=this._quantified[r.id]),r}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blank(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blank(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){var t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blank()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blank()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);var t=null===this._predicate;return this._restoreContext(),null===this._object?t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){var t=null,r=null,n=this._subject,i=this._contextStack,s=i[i.length-1],a=this._readListItem;switch(e.type){case"[":this._saveContext("blank",this._graph,r=this._blank(),this.RDF_FIRST,this._subject=t=this._blank()),a=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,r=this._blank(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==i.length&&"list"===i[i.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(a=this._readPredicate,this._subject===this.RDF_NIL)return a}else if(a=this._getContextEndReader(),this._object===this.RDF_NIL)return a;r=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,a=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),a=this._getContextEndReader());break;default:if(void 0===(t=this._readEntity(e)))return}if(null===r&&(this._subject=r=this._blank()),null===n?null===s.predicate?s.subject=r:s.object=r:this._emit(n,this.RDF_REST,r,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,r,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(r,this.RDF_FIRST,t,this._graph)}return a}_readDataTypeOrLang(e){return this._completeLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeLiteral(e,!0)}_completeLiteral(e,t){switch(e.type){case"type":case"typeIRI":var r=this._readEntity(e);if(void 0===r)return;this._object=this._literal(this._literalValue,r),e=null;break;case"langcode":this._object=this._literal(this._literalValue,e.value),e=null;break;default:this._object=this._literal(this._literalValue)}return t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===e?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(e))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){var t,r=this._subject,n=this._graph,i=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error('Expected punctuation to follow "'+this._object.id+'"',e)}if(null!==r){var s=this._predicate,a=this._object;i?this._emit(a,s,r,n):this._emit(r,s,a,n)}return t}_readBlankNodePunctuation(e){var t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object.id+'"',e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',e);var t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){var t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blank(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){var t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error("Unexpected "+e.type,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blank(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blank(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier("b"+o++),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:var t=this._contextStack,r=t.length&&t[t.length-1];if(r&&"item"===r.type){var n=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,n,this._graph)}return this._afterPath(e)}}_readForwardPath(e){var t,r,n=this._blank();if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=n):(t=this._object,this._object=n),this._emit(t,r,n,this._graph),this._readPath}_readBackwardPath(e){var t,r,n=this._blank();if(void 0!==(t=this._readEntity(e)))return null===this._predicate?(r=this._subject,this._subject=n):(r=this._object,this._object=n),this._emit(n,t,r,this._graph),this._readPath}_getContextEndReader(){var e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail}}_emit(e,t,r,n){this._callback(null,this._quad(e,t,r,n||this.DEFAULTGRAPH))}_error(e,t){var r=new Error(e+" on line "+t.line+".");r.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(r),this._callback=c}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?"":this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;for(var t="",r=e.length,n=-1,i=-1,s=0,a="/";n<r;){switch(a){case":":if(i<0&&"/"===e[++n]&&"/"===e[++n])for(;(i=n+1)<r&&"/"!==e[i];)n=i;break;case"?":case"#":n=r;break;case"/":if("."===e[n+1])switch(a=e[++n+1]){case"/":t+=e.substring(s,n-1),s=n+1;break;case void 0:case"?":case"#":return t+e.substring(s,n)+e.substr(n+1);case".":if(void 0===(a=e[++n+1])||"/"===a||"?"===a||"#"===a){if((s=(t+=e.substring(s,n-2)).lastIndexOf("/"))>=i&&(t=t.substr(0,s)),"/"!==a)return t+"/"+e.substr(n+1);s=n+1}}}a=e[++n]}return t+e.substring(s)}parse(e,t,r){var n=this;if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):"b"+a+++"_",this._prefixCallback=r||c,this._inversePredicate=!1,this._quantified=Object.create(null),!t){var i,s=[];if(this._callback=function(e,t){e?i=e:t&&s.push(t)},this._lexer.tokenize(e).every(function(e){return n._readCallback=n._readCallback(e)}),i)throw i;return s}this._callback=t,this._lexer.tokenize(e,function(e,t){null!==e?(n._callback(e),n._callback=c):n._readCallback&&(n._readCallback=n._readCallback(t))})}}function c(){}function l(e,t){var r=t.namedNode;e._namedNode=r,e._blankNode=t.blankNode,e._literal=t.literal,e._variable=t.variable,e._quad=t.quad,e.DEFAULTGRAPH=t.defaultGraph(),e.RDF_FIRST=r(s.rdf.first),e.RDF_REST=r(s.rdf.rest),e.RDF_NIL=r(s.rdf.nil),e.N3_FORALL=r(s.r.forAll),e.N3_FORSOME=r(s.r.forSome),e.ABBREVIATIONS={a:r(s.rdf.type),"=":r(s.owl.sameAs),">":r(s.log.implies)},e.QUANTIFIERS_GRAPH=r("urn:n3:quantifiers")}l(u.prototype,i),t.exports=u},{"./IRIs":17,"./N3DataFactory":18,"./N3Lexer":19}],21:[function(e,t,r){var n=e("./N3DataFactory"),i=n.internal.toId,s=n.internal.fromId;function a(e){return"string"==typeof e||e instanceof String}t.exports=class{constructor(e,t){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._factory=t.factory||n,e&&this.addQuads(e)}get size(){var e=this._size;if(null!==e)return e;e=0;var t,r,n=this._graphs;for(var i in n)for(var s in t=n[i].subjects)for(var a in r=t[s])e+=Object.keys(r[a]).length;return this._size=e}_addToIndex(e,t,r,n){var i=e[t]||(e[t]={}),s=i[r]||(i[r]={}),a=n in s;return a||(s[n]=null),!a}_removeFromIndex(e,t,r,n){var i,s=e[t],a=s[r];for(i in delete a[n],a)return;for(i in delete s[r],s)return;delete e[t]}_findInIndex(e,t,r,n,i,a,o,u,c,l){var f,h,p,d=!t+!r+!n>1?Object.keys(this._ids):this._entities;for(var v in t&&((f=e,e={})[t]=f[t]),e){var g=d[v];if(h=e[v])for(var y in r&&((f=h,h={})[r]=f[r]),h){var m=d[y];if(p=h[y])for(var b=(n?n in p?[n]:[]:Object.keys(p)),_=0;_<b.length;_++){var x={subject:null,predicate:null,object:null};x[i]=s(g,this._factory),x[a]=s(m,this._factory),x[o]=s(d[b[_]],this._factory);var w=this._factory.quad(x.subject,x.predicate,x.object,s(u,this._factory));if(l)l.push(w);else if(c(w))return!0}}}return l}_loop(e,t){for(var r in e)t(r)}_loopByKey0(e,t,r){var n,i;if(n=e[t])for(i in n)r(i)}_loopByKey1(e,t,r){var n;for(n in e)e[n][t]&&r(n)}_loopBy2Keys(e,t,r,n){var i,s,a;if((i=e[t])&&(s=i[r]))for(a in s)n(a)}_countInIndex(e,t,r,n){var i,s,a,o=0;for(var u in t&&((i=e,e={})[t]=i[t]),e)if(s=e[u])for(var c in r&&((i=s,s={})[r]=i[r]),s)(a=s[c])&&(n?n in a&&o++:o+=Object.keys(a).length);return o}_getGraphs(e){if(!a(e))return this._graphs;var t={};return t[e]=this._graphs[e],t}_uniqueEntities(e){var t=Object.create(null),r=this._entities;return function(n){n in t||(t[n]=!0,e(s(r[n])))}}addQuad(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),e=i(e),t=i(t),r=i(r),n=i(n);var s=this._graphs[n];s||(s=this._graphs[n]={subjects:{},predicates:{},objects:{}},Object.freeze(s));var a=this._ids,o=this._entities;e=a[e]||(a[o[++this._id]=e]=this._id),t=a[t]||(a[o[++this._id]=t]=this._id),r=a[r]||(a[o[++this._id]=r]=this._id);var u=this._addToIndex(s.subjects,e,t,r);return this._addToIndex(s.predicates,t,r,e),this._addToIndex(s.objects,r,e,t),this._size=null,u}addQuads(e){for(var t=0;t<e.length;t++)this.addQuad(e[t])}import(e){var t=this;return e.on("data",function(e){t.addQuad(e)}),e}removeQuad(e,t,r,n){t||(n=e.graph,r=e.object,t=e.predicate,e=e.subject),e=i(e),t=i(t),r=i(r),n=i(n);var s,a,o,u=this._ids,c=this._graphs;if(!((e=u[e])&&(t=u[t])&&(r=u[r])&&(s=c[n])&&(a=s.subjects[e])&&(o=a[t])&&r in o))return!1;for(e in this._removeFromIndex(s.subjects,e,t,r),this._removeFromIndex(s.predicates,t,r,e),this._removeFromIndex(s.objects,r,e,t),null!==this._size&&this._size--,s.subjects)return!0;return delete c[n],!0}removeQuads(e){for(var t=0;t<e.length;t++)this.removeQuad(e[t])}remove(e){var t=this;return e.on("data",function(e){t.removeQuad(e)}),e}getQuads(e,t,r,n){e=e&&i(e),t=t&&i(t),r=r&&i(r),n=n&&i(n);var s,o,u,c,l=[],f=this._getGraphs(n),h=this._ids;if(a(e)&&!(o=h[e])||a(t)&&!(u=h[t])||a(r)&&!(c=h[r]))return l;for(var p in f)(s=f[p])&&(o?c?this._findInIndex(s.objects,c,o,u,"object","subject","predicate",p,null,l):this._findInIndex(s.subjects,o,u,null,"subject","predicate","object",p,null,l):u?this._findInIndex(s.predicates,u,c,null,"predicate","object","subject",p,null,l):c?this._findInIndex(s.objects,c,null,null,"object","subject","predicate",p,null,l):this._findInIndex(s.subjects,null,null,null,"subject","predicate","object",p,null,l));return l}countQuads(e,t,r,n){e=e&&i(e),t=t&&i(t),r=r&&i(r),n=n&&i(n);var s,o,u,c,l=0,f=this._getGraphs(n),h=this._ids;if(a(e)&&!(o=h[e])||a(t)&&!(u=h[t])||a(r)&&!(c=h[r]))return 0;for(var p in f)(s=f[p])&&(l+=e?r?this._countInIndex(s.objects,c,o,u):this._countInIndex(s.subjects,o,u,c):t?this._countInIndex(s.predicates,u,c,o):this._countInIndex(s.objects,c,o,u));return l}forEach(e,t,r,n,i){this.some(function(t){return e(t),!1},t,r,n,i)}every(e,t,r,n,i){var s=!1,a=!this.some(function(t){return s=!0,!e(t)},t,r,n,i);return s&&a}some(e,t,r,n,s){t=t&&i(t),r=r&&i(r),n=n&&i(n),s=s&&i(s);var o,u,c,l,f=this._getGraphs(s),h=this._ids;if(a(t)&&!(u=h[t])||a(r)&&!(c=h[r])||a(n)&&!(l=h[n]))return!1;for(var p in f)if(o=f[p])if(u){if(l){if(this._findInIndex(o.objects,l,u,c,"object","subject","predicate",p,e,null))return!0}else if(this._findInIndex(o.subjects,u,c,null,"subject","predicate","object",p,e,null))return!0}else if(c){if(this._findInIndex(o.predicates,c,l,null,"predicate","object","subject",p,e,null))return!0}else if(l){if(this._findInIndex(o.objects,l,null,null,"object","subject","predicate",p,e,null))return!0}else if(this._findInIndex(o.subjects,null,null,null,"subject","predicate","object",p,e,null))return!0;return!1}getSubjects(e,t,r){var n=[];return this.forSubjects(function(e){n.push(e)},e,t,r),n}forSubjects(e,t,r,n){t=t&&i(t),r=r&&i(r),n=n&&i(n);var s,o,u,c=this._ids,l=this._getGraphs(n);if(e=this._uniqueEntities(e),!(a(t)&&!(o=c[t])||a(r)&&!(u=c[r])))for(n in l)(s=l[n])&&(o?u?this._loopBy2Keys(s.predicates,o,u,e):this._loopByKey1(s.subjects,o,e):u?this._loopByKey0(s.objects,u,e):this._loop(s.subjects,e))}getPredicates(e,t,r){var n=[];return this.forPredicates(function(e){n.push(e)},e,t,r),n}forPredicates(e,t,r,n){t=t&&i(t),r=r&&i(r),n=n&&i(n);var s,o,u,c=this._ids,l=this._getGraphs(n);if(e=this._uniqueEntities(e),!(a(t)&&!(o=c[t])||a(r)&&!(u=c[r])))for(n in l)(s=l[n])&&(o?u?this._loopBy2Keys(s.objects,u,o,e):this._loopByKey0(s.subjects,o,e):u?this._loopByKey1(s.predicates,u,e):this._loop(s.predicates,e))}getObjects(e,t,r){var n=[];return this.forObjects(function(e){n.push(e)},e,t,r),n}forObjects(e,t,r,n){t=t&&i(t),r=r&&i(r),n=n&&i(n);var s,o,u,c=this._ids,l=this._getGraphs(n);if(e=this._uniqueEntities(e),!(a(t)&&!(o=c[t])||a(r)&&!(u=c[r])))for(n in l)(s=l[n])&&(o?u?this._loopBy2Keys(s.subjects,o,u,e):this._loopByKey1(s.objects,o,e):u?this._loopByKey0(s.predicates,u,e):this._loop(s.objects,e))}getGraphs(e,t,r){var n=[];return this.forGraphs(function(e){n.push(e)},e,t,r),n}forGraphs(e,t,r,n){for(var i in this._graphs)this.some(function(t){return e(t.graph),!0},t,r,n,i)}createBlankNode(e){var t,r;if(e)for(t=e="_:"+e,r=1;this._ids[t];)t=e+r++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,this._factory.blankNode(t.substr(2))}}},{"./N3DataFactory":18}],22:[function(e,t,r){var n=e("stream").Transform,i=e("./N3Parser.js");t.exports=class extends n{constructor(e){super({decodeStrings:!0}),this._readableState.objectMode=!0;var t,r,n=this;new i(e).parse({on:function(e,n){switch(e){case"data":t=n;break;case"end":r=n}}},function(e,t){e&&n.emit("error",e)||t&&n.push(t)},function(e,t){n.emit("prefix",e,t)}),this._transform=function(e,r,n){t(e),n()},this._flush=function(e){r(),e()}}import(e){var t=this;return e.on("data",function(e){t.write(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.emit("error",e)}),this}}},{"./N3Parser.js":20,stream:43}],23:[function(e,t,r){var n=e("stream").Transform,i=e("./N3Writer.js");t.exports=class extends n{constructor(e){super({encoding:"utf8"}),this._writableState.objectMode=!0;var t=this,r=this._writer=new i({write:function(e,r,n){t.push(e),n&&n()},end:function(e){t.push(null),e&&e()}},e);this._transform=function(e,t,n){r.addQuad(e,n)},this._flush=function(e){r.end(e)}}import(e){var t=this;return e.on("data",function(e){t.write(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.emit("error",e)}),e.on("prefix",function(e,r){t._writer.addPrefix(e,r)}),this}}},{"./N3Writer.js":25,stream:43}],24:[function(e,t,r){var n=e("./N3DataFactory"),i={isNamedNode:function(e){return!!e&&"NamedNode"===e.termType},isBlankNode:function(e){return!!e&&"BlankNode"===e.termType},isLiteral:function(e){return!!e&&"Literal"===e.termType},isVariable:function(e){return!!e&&"Variable"===e.termType},isDefaultGraph:function(e){return!!e&&"DefaultGraph"===e.termType},inDefaultGraph:function(e){return i.isDefaultGraph(e.graph)},prefix:function(e,t){return i.prefixes({"":e},t)("")},prefixes:function(e,t){var r=Object.create(null);for(var i in e)s(i,e[i]);function s(e,n){if("string"==typeof n){var i=Object.create(null);r[e]=function(e){return i[e]||(i[e]=t.namedNode(n+e))}}else if(!(e in r))throw new Error("Unknown prefix: "+e);return r[e]}return t=t||n,s}};t.exports=i},{"./N3DataFactory":18}],25:[function(e,t,r){var n=e("./IRIs"),i=e("./N3DataFactory"),s=i.defaultGraph(),a=n.rdf,o=n.xsd,u=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,c=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,l={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class f extends i.internal.Term{equals(){return!1}}function h(e){var t=l[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}t.exports=class{constructor(e,t){if(this._prefixRegex=/$0^/,e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var r="";this._outputStream={write(e,t,n){r+=e,n&&n()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?this._writeQuad=this._writeQuadLine:(this._graph=s,this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}get _inDefaultGraph(){return s.equals(this._graph)}_write(e,t){this._outputStream.write(e,"utf8",t)}_writeQuad(e,t,r,n,i){try{n.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(s.equals(n)?"":this._encodeIriOrBlank(n)+" {\n")),this._graph=n,this._subject=null),e.equals(this._subject)?t.equals(this._predicate)?this._write(", "+this._encodeObject(r),i):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),i):this._write((null===this._subject?"":".\n")+this._encodeIriOrBlank(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(r),i)}catch(e){i&&i(e)}}_writeQuadLine(e,t,r,n,i){delete this._prefixMatch,this._write(this.quadToString(e,t,r,n),i)}quadToString(e,t,r,n){return this._encodeIriOrBlank(e)+" "+this._encodeIriOrBlank(t)+" "+this._encodeObject(r)+(n&&n.value?" "+this._encodeIriOrBlank(n)+" .\n":" .\n")}quadsToString(e){return e.map(function(e){return this.quadToString(e.subject,e.predicate,e.object,e.graph)},this).join("")}_encodeIriOrBlank(e){if("NamedNode"!==e.termType)return"id"in e?e.id:"_:"+e.value;var t=e.value;u.test(t)&&(t=t.replace(c,h));var r=this._prefixRegex.exec(t);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:t:"<"+t+">"}_encodeLiteral(e){var t=e.value;return u.test(t)&&(t=t.replace(c,h)),e.language?'"'+t+'"@'+e.language:e.datatype.value!==o.string?'"'+t+'"^^'+this._encodeIriOrBlank(e.datatype):'"'+t+'"'}_encodePredicate(e){return e.value===a.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){return"Literal"===e.termType?this._encodeLiteral(e):this._encodeIriOrBlank(e)}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,t,r,n,i){void 0===r?this._writeQuad(e.subject,e.predicate,e.object,e.graph,t):"function"==typeof n?this._writeQuad(e,t,r,s,n):this._writeQuad(e,t,r,n||s,i)}addQuads(e){for(var t=0;t<e.length;t++)this.addQuad(e[t])}addPrefix(e,t,r){var n={};n[e]=t,this.addPrefixes(n,r)}addPrefixes(e,t){var r=this._prefixIRIs,n=!1;for(var i in e){var s=e[i];"string"!=typeof s&&(s=s.value),/[#\/]$/.test(s)&&r[s]!==(i+=":")&&(n=!0,r[s]=i,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._write("@prefix "+i+" <"+s+">.\n"))}if(n){var a="",o="";for(var u in r)a+=a?"|"+u:u,o+=(o?"|":"")+r[u];a=a.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+o+")[^/]*$|^("+a+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(n?"\n":"",t)}blank(e,t){var r,n,i=e;switch(void 0===e?i=[]:e.termType?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),n=i.length){case 0:return new f("[]");case 1:if(!((r=i[0]).object instanceof f))return new f("[ "+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object)+" ]");default:for(var s="[",a=0;a<n;a++)(r=i[a]).predicate.equals(e)?s+=", "+this._encodeObject(r.object):(s+=(a?";\n  ":"\n  ")+this._encodePredicate(r.predicate)+" "+this._encodeObject(r.object),e=r.predicate);return new f(s+"\n]")}}list(e){for(var t=e&&e.length||0,r=new Array(t),n=0;n<t;n++)r[n]=this._encodeObject(e[n]);return new f("("+r.join(" ")+")")}end(e){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;var t=e&&function(r,n){t=null,e(r,n)};if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}}},{"./IRIs":17,"./N3DataFactory":18}],26:[function(e,t,r){(function(e){"use strict";!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,r,n,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var s,a,o=arguments.length;switch(o){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,r)});case 3:return e.nextTick(function(){t.call(null,r,n)});case 4:return e.nextTick(function(){t.call(null,r,n,i)});default:for(s=new Array(o-1),a=0;a<s.length;)s[a++]=arguments[a];return e.nextTick(function(){t.apply(null,s)})}}}:t.exports=e}).call(this,e("_process"))},{_process:27}],27:[function(e,t,r){var n,i,s=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var c,l=[],f=!1,h=-1;function p(){f&&c&&(f=!1,c.length?l=c.concat(l):h=-1,l.length&&d())}function d(){if(!f){var e=u(p);f=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,f=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function g(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new v(e,t)),1!==l.length||f||u(d)},v.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.prependListener=g,s.prependOnceListener=g,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],28:[function(e,t,r){t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":29}],29:[function(e,t,r){"use strict";var n=e("process-nextick-args"),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=f;var s=e("core-util-is");s.inherits=e("inherits");var a=e("./_stream_readable"),o=e("./_stream_writable");s.inherits(f,a);for(var u=i(o.prototype),c=0;c<u.length;c++){var l=u[c];f.prototype[l]||(f.prototype[l]=o.prototype[l])}function f(e){if(!(this instanceof f))return new f(e);a.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||n.nextTick(p,this)}function p(e){e.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),f.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},{"./_stream_readable":31,"./_stream_writable":33,"core-util-is":10,inherits:13,"process-nextick-args":26}],30:[function(e,t,r){"use strict";t.exports=s;var n=e("./_stream_transform"),i=e("core-util-is");function s(e){if(!(this instanceof s))return new s(e);n.call(this,e)}i.inherits=e("inherits"),i.inherits(s,n),s.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":32,"core-util-is":10,inherits:13}],31:[function(e,t,r){(function(r,n){"use strict";var i=e("process-nextick-args");t.exports=b;var s,a=e("isarray");b.ReadableState=m;e("events").EventEmitter;var o=function(e,t){return e.listeners(t).length},u=e("./internal/streams/stream"),c=e("safe-buffer").Buffer,l=n.Uint8Array||function(){};var f=e("core-util-is");f.inherits=e("inherits");var h=e("util"),p=void 0;p=h&&h.debuglog?h.debuglog("stream"):function(){};var d,v=e("./internal/streams/BufferList"),g=e("./internal/streams/destroy");f.inherits(b,u);var y=["error","close","destroy","pause","resume"];function m(t,r){s=s||e("./_stream_duplex"),t=t||{};var n=r instanceof s;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,a=t.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(a||0===a)?a:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=e("string_decoder/").StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function b(t){if(s=s||e("./_stream_duplex"),!(this instanceof b))return new b(t);this._readableState=new m(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),u.call(this)}function _(e,t,r,n,i){var s,a=e._readableState;null===t?(a.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,E(e)}(e,a)):(i||(s=function(e,t){var r;n=t,c.isBuffer(n)||n instanceof l||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(a,t)),s?e.emit("error",s):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):x(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?x(e,a,t,!1):k(e,a)):x(e,a,t,!1))):n||(a.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function x(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&E(e)),k(e,t)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=g.destroy,b.prototype._undestroy=g.undestroy,b.prototype._destroy=function(e,t){this.push(null),t(e)},b.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),_(this,e,t,!1,r)},b.prototype.unshift=function(e){return _(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return d||(d=e("string_decoder/").StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t,this};var w=8388608;function S(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=w?e=w:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function E(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(p("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(j,e):j(e))}function j(e){p("emit readable"),e.emit("readable"),A(e)}function k(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(O,e,t))}function O(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(p("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function I(e){p("readable nexttick read 0"),e.read(0)}function T(e,t){t.reading||(p("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),A(e),t.flowing&&!t.reading&&e.read(0)}function A(e){var t=e._readableState;for(p("flow",t.flowing);t.flowing&&null!==e.read(););}function N(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;e-=i.length;for(;r=r.next;){var s=r.data,a=e>s.length?s.length:e;if(a===s.length?i+=s:i+=s.slice(0,e),0===(e-=a)){a===s.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=s.slice(a));break}++n}return t.length-=n,i}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,i=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var s=n.data,a=e>s.length?s.length:e;if(s.copy(r,r.length-e,0,a),0===(e-=a)){a===s.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=s.slice(a));break}++i}return t.length-=i,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function R(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(L,t,e))}function L(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function C(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}b.prototype.read=function(e){p("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return p("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?R(this):E(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&R(this),null;var n,i=t.needReadable;return p("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&p("length less than watermark",i=!0),t.ended||t.reading?p("reading or ended",i=!1):i&&(p("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(r,t))),null===(n=e>0?N(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&R(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(e,t){var n=this,s=this._readableState;switch(s.pipesCount){case 0:s.pipes=e;break;case 1:s.pipes=[s.pipes,e];break;default:s.pipes.push(e)}s.pipesCount+=1,p("pipe count=%d opts=%j",s.pipesCount,t);var u=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:b;function c(t,r){p("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,p("cleanup"),e.removeListener("close",y),e.removeListener("finish",m),e.removeListener("drain",f),e.removeListener("error",g),e.removeListener("unpipe",c),n.removeListener("end",l),n.removeListener("end",b),n.removeListener("data",v),h=!0,!s.awaitDrain||e._writableState&&!e._writableState.needDrain||f())}function l(){p("onend"),e.end()}s.endEmitted?i.nextTick(u):n.once("end",u),e.on("unpipe",c);var f=function(e){return function(){var t=e._readableState;p("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,A(e))}}(n);e.on("drain",f);var h=!1;var d=!1;function v(t){p("ondata"),d=!1,!1!==e.write(t)||d||((1===s.pipesCount&&s.pipes===e||s.pipesCount>1&&-1!==C(s.pipes,e))&&!h&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function g(t){p("onerror",t),b(),e.removeListener("error",g),0===o(e,"error")&&e.emit("error",t)}function y(){e.removeListener("finish",m),b()}function m(){p("onfinish"),e.removeListener("close",y),b()}function b(){p("unpipe"),n.unpipe(e)}return n.on("data",v),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?a(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",y),e.once("finish",m),e.emit("pipe",n),s.flowing||(p("pipe resume"),n.resume()),e},b.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<i;s++)n[s].emit("unpipe",this,r);return this}var a=C(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},b.prototype.on=function(e,t){var r=u.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&E(this):i.nextTick(I,this))}return r},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var e=this._readableState;return e.flowing||(p("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(T,e,t))}(this,e)),this},b.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",function(){if(p("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(i){(p("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var s=0;s<y.length;s++)e.on(y[s],this.emit.bind(this,y[s]));return this._read=function(t){p("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=N}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":29,"./internal/streams/BufferList":34,"./internal/streams/destroy":35,"./internal/streams/stream":36,_process:27,"core-util-is":10,events:11,inherits:13,isarray:15,"process-nextick-args":26,"safe-buffer":42,"string_decoder/":37,util:8}],32:[function(e,t,r){"use strict";t.exports=s;var n=e("./_stream_duplex"),i=e("core-util-is");function s(e){if(!(this instanceof s))return new s(e);n.call(this,e),this._transformState={afterTransform:function(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush(function(t,r){o(e,t,r)}):o(this,null,null)}function o(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=e("inherits"),i.inherits(s,n),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},s.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},s.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})}},{"./_stream_duplex":29,"core-util-is":10,inherits:13}],33:[function(e,t,r){(function(r,n,i){"use strict";var s=e("process-nextick-args");function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}t.exports=m;var o,u=!r.browser&&["v0.10","v0.9."].indexOf(r.version.slice(0,5))>-1?i:s.nextTick;m.WritableState=y;var c=e("core-util-is");c.inherits=e("inherits");var l={deprecate:e("util-deprecate")},f=e("./internal/streams/stream"),h=e("safe-buffer").Buffer,p=n.Uint8Array||function(){};var d,v=e("./internal/streams/destroy");function g(){}function y(t,r){o=o||e("./_stream_duplex"),t=t||{};var n=r instanceof o;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,c=t.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(c||0===c)?c:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var f=!1===t.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?(s.nextTick(i,n),s.nextTick(E,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(i(n),e._writableState.errorEmitted=!0,e.emit("error",n),E(e,t))}(e,r,n,t,i);else{var a=w(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||x(e,r),n?u(_,e,r,a,i):_(e,r,a,i)}}(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function m(t){if(o=o||e("./_stream_duplex"),!(d.call(m,this)||this instanceof o))return new m(t);this._writableState=new y(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),f.call(this)}function b(e,t,r,n,i,s,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function _(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),E(e,t)}function x(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var o=0,u=!0;r;)i[o]=r,r.isBuf||(u=!1),r=r.next,o+=1;i.allBuffers=u,b(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,l=r.encoding,f=r.callback;if(b(e,t,!1,t.objectMode?1:c.length,c,l,f),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function w(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function S(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),E(e,t)})}function E(e,t){var r=w(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,s.nextTick(S,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}c.inherits(m,f),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!d.call(this,e)||this===m&&(e&&e._writableState instanceof y)}})):d=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,r){var n,i=this._writableState,a=!1,o=!i.objectMode&&(n=e,h.isBuffer(n)||n instanceof p);return o&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=g),i.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),s.nextTick(t,r)}(this,r):(o||function(e,t,r,n){var i=!0,a=!1;return null===r?a=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),s.nextTick(n,a),i=!1),i}(this,i,e,r))&&(i.pendingcb++,a=function(e,t,r,n,i,s){if(!r){var a=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,r));return t}(t,n,i);n!==a&&(r=!0,i="buffer",n=a)}var o=t.objectMode?1:n.length;t.length+=o;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:s,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else b(e,t,!1,o,n,i,s);return u}(this,i,o,e,t,r)),a},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||x(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,E(e,t),r&&(t.finished?s.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=v.destroy,m.prototype._undestroy=v.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{"./_stream_duplex":29,"./internal/streams/destroy":35,"./internal/streams/stream":36,_process:27,"core-util-is":10,inherits:13,"process-nextick-args":26,"safe-buffer":42,timers:44,"util-deprecate":45}],34:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("util");t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,i,s=n.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=a.data,r=s,i=o,t.copy(r,i),o+=a.data.length,a=a.next;return s},e}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":42,util:8}],35:[function(e,t,r){"use strict";var n=e("process-nextick-args");function i(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var r=this,s=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return s||a?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(n.nextTick(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":26}],36:[function(e,t,r){t.exports=e("events").EventEmitter},{events:11}],37:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=l,this.end=f,t=3;break;default:return this.write=h,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function l(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}r.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=a(t[n]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--n<r||-2===i)return 0;if((i=a(t[n]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--n<r||-2===i)return 0;if((i=a(t[n]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":42}],38:[function(e,t,r){t.exports=e("./readable").PassThrough},{"./readable":39}],39:[function(e,t,r){(r=t.exports=e("./lib/_stream_readable.js")).Stream=r,r.Readable=r,r.Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":29,"./lib/_stream_passthrough.js":30,"./lib/_stream_readable.js":31,"./lib/_stream_transform.js":32,"./lib/_stream_writable.js":33}],40:[function(e,t,r){t.exports=e("./readable").Transform},{"./readable":39}],41:[function(e,t,r){t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":33}],42:[function(e,t,r){var n=e("buffer"),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(s(n,r),r.Buffer=a),s(i,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:9}],43:[function(e,t,r){t.exports=i;var n=e("events").EventEmitter;function i(){n.call(this)}e("inherits")(i,n),i.Readable=e("readable-stream/readable.js"),i.Writable=e("readable-stream/writable.js"),i.Duplex=e("readable-stream/duplex.js"),i.Transform=e("readable-stream/transform.js"),i.PassThrough=e("readable-stream/passthrough.js"),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function s(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",s),e._isStdio||t&&!1===t.end||(r.on("end",o),r.on("close",u));var a=!1;function o(){a||(a=!0,e.end())}function u(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(l(),0===n.listenerCount(this,"error"))throw e}function l(){r.removeListener("data",i),e.removeListener("drain",s),r.removeListener("end",o),r.removeListener("close",u),r.removeListener("error",c),e.removeListener("error",c),r.removeListener("end",l),r.removeListener("close",l),e.removeListener("close",l)}return r.on("error",c),e.on("error",c),r.on("end",l),r.on("close",l),e.on("close",l),e.emit("pipe",r),e}},{events:11,inherits:13,"readable-stream/duplex.js":28,"readable-stream/passthrough.js":38,"readable-stream/readable.js":39,"readable-stream/transform.js":40,"readable-stream/writable.js":41}],44:[function(e,t,r){(function(t,n){var i=e("process/browser.js").nextTick,s=Function.prototype.apply,a=Array.prototype.slice,o={},u=0;function c(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new c(s.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new c(s.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r.setImmediate="function"==typeof t?t:function(e){var t=u++,n=!(arguments.length<2)&&a.call(arguments,1);return o[t]=!0,i(function(){o[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))}),t},r.clearImmediate="function"==typeof n?n:function(e){delete o[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":27,timers:44}],45:[function(e,t,r){(function(e){function r(t){try{if(!e.localStorage)return!1}catch(e){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}t.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(e,t,r){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],47:[function(e,t,r){(function(t,n){var i=/%[sdj%]/g;r.format=function(e){if(!y(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(o(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,s=n.length,a=String(e).replace(i,function(e){if("%%"===e)return"%";if(r>=s)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),u=n[r];r<s;u=n[++r])v(u)||!_(u)?a+=" "+u:a+=" "+o(u);return a},r.deprecate=function(e,i){if(m(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var s=!1;return function(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}};var s,a={};function o(e,t){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),d(t)?n.showHidden=t:t&&r._extend(n,t),m(n.showHidden)&&(n.showHidden=!1),m(n.depth)&&(n.depth=2),m(n.colors)&&(n.colors=!1),m(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),l(n,e,n.depth)}function u(e,t){var r=o.styles[t];return r?"["+o.colors[r][0]+"m"+e+"["+o.colors[r][1]+"m":e}function c(e,t){return e}function l(e,t,n){if(e.customInspect&&t&&S(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return y(i)||(i=l(e,i,n)),i}var s=function(e,t){if(m(t))return e.stylize("undefined","undefined");if(y(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(g(t))return e.stylize(""+t,"number");if(d(t))return e.stylize(""+t,"boolean");if(v(t))return e.stylize("null","null")}(e,t);if(s)return s;var a=Object.keys(t),o=function(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),w(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(t);if(0===a.length){if(S(t)){var u=t.name?": "+t.name:"";return e.stylize("[Function"+u+"]","special")}if(b(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(x(t))return e.stylize(Date.prototype.toString.call(t),"date");if(w(t))return f(t)}var c,_="",E=!1,j=["{","}"];(p(t)&&(E=!0,j=["[","]"]),S(t))&&(_=" [Function"+(t.name?": "+t.name:"")+"]");return b(t)&&(_=" "+RegExp.prototype.toString.call(t)),x(t)&&(_=" "+Date.prototype.toUTCString.call(t)),w(t)&&(_=" "+f(t)),0!==a.length||E&&0!=t.length?n<0?b(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=E?function(e,t,r,n,i){for(var s=[],a=0,o=t.length;a<o;++a)O(t,String(a))?s.push(h(e,t,r,n,String(a),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(h(e,t,r,n,i,!0))}),s}(e,t,n,o,a):a.map(function(r){return h(e,t,n,o,r,E)}),e.seen.pop(),function(e,t,r){if(e.reduce(function(e,t){return 0,t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,_,j)):j[0]+_+j[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,r,n,i,s){var a,o,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?o=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(o=e.stylize("[Setter]","special")),O(n,i)||(a="["+i+"]"),o||(e.seen.indexOf(u.value)<0?(o=v(r)?l(e,u.value,null):l(e,u.value,r-1)).indexOf("\n")>-1&&(o=s?o.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+o.split("\n").map(function(e){return"   "+e}).join("\n")):o=e.stylize("[Circular]","special")),m(a)){if(s&&i.match(/^\d+$/))return o;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+o}function p(e){return Array.isArray(e)}function d(e){return"boolean"==typeof e}function v(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function m(e){return void 0===e}function b(e){return _(e)&&"[object RegExp]"===E(e)}function _(e){return"object"==typeof e&&null!==e}function x(e){return _(e)&&"[object Date]"===E(e)}function w(e){return _(e)&&("[object Error]"===E(e)||e instanceof Error)}function S(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}function j(e){return e<10?"0"+e.toString(10):e.toString(10)}r.debuglog=function(e){if(m(s)&&(s=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(s)){var n=t.pid;a[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else a[e]=function(){};return a[e]},r.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=p,r.isBoolean=d,r.isNull=v,r.isNullOrUndefined=function(e){return null==e},r.isNumber=g,r.isString=y,r.isSymbol=function(e){return"symbol"==typeof e},r.isUndefined=m,r.isRegExp=b,r.isObject=_,r.isDate=x,r.isError=w,r.isFunction=S,r.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},r.isBuffer=e("./support/isBuffer");var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[j(e.getHours()),j(e.getMinutes()),j(e.getSeconds())].join(":"),[e.getDate(),k[e.getMonth()],t].join(" ")),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!_(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":46,_process:27,inherits:13}],48:[function(e,t,r){var n=function(){var e=/^[a-z][a-z0-9+.-]*:/i,t=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,r=/(?:^|\/)\.\.?(?:$|[\/#?])/;const n="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",i="http://www.w3.org/2001/XMLSchema#string";function s(e){if(!r.test(e))return e;for(var t="",n=e.length,i=-1,s=-1,a=0,o="/";i<n;){switch(o){case":":if(s<0&&"/"===e[++i]&&"/"===e[++i])for(;(s=i+1)<n&&"/"!==e[s];)i=s;break;case"?":case"#":i=n;break;case"/":if("."===e[i+1])switch(o=e[++i+1]){case"/":t+=e.substring(a,i-1),a=i+1;break;case void 0:case"?":case"#":return t+e.substring(a,i)+e.substr(i+1);case".":if(void 0===(o=e[++i+1])||"/"===o||"?"===o||"#"===o){if((a=(t+=e.substring(a,i-2)).lastIndexOf("/"))>=s&&(t=t.substr(0,a)),"/"!==o)return t+"/"+e.substr(i+1);a=i+1}}}o=e[++i]}return t+e.substring(a)}function a(e){switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return"_:"+e.value;case"Literal":return'"'+e.value+'"'+(e.datatypeString===n?"@"+e.language:e.datatypeString===i?"":"^^"+e.datatypeString);default:throw Error("unknown RDFJS node type: "+JSON.stringify(e))}}function o(e,t){if(u(e))return t.namedNode(e);if(l(e))return t.blankNode(e.substr(2));if(c(e))return t.literal(f(e),p(e)||t.namedNode(h(e)));throw Error("Unknown internal term type: "+JSON.stringify(e))}function u(e){if("string"!=typeof e)return!1;if(0===e.length)return!0;var t=e[0];return'"'!==t&&"_"!==t}function c(e){return"string"==typeof e&&'"'===e[0]}function l(e){return"string"==typeof e&&"_:"===e.substr(0,2)}function f(e){var t=/^"([^]*)"/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]}function h(e){var t=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]||(t[2]?n:i)}function p(e){var t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""}var d=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,v=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,g={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};function y(e){var t=g[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}return{RdfLangString:n,XsdString:i,resolveRelativeIRI:function(r,n){if(e.test(n))return n;switch(n[0]){case void 0:return r;case"#":return r+n;case"?":return r.replace(/(?:\?.*)?$/,n);case"/":let e=r.match(t);return("/"===n[1]?e[1]:e[0])+s(n);default:return s(r.replace(/[^\/?]*(?:\?.*)?$/,"")+n)}},isIRI:u,isLiteral:c,isBlank:l,isDefaultGraph:function(e){return!e},inDefaultGraph:function(e){return!e.graph},getLiteralValue:f,getLiteralType:h,getLiteralLanguage:p,internalTerm:a,internalTriple:function(e){return{subject:a(e.subject),predicate:a(e.predicate),object:a(e.object)}},externalTerm:o,externalTriple:function(e,t){return{subject:o(e.subject,t),predicate:o(e.predicate,t),object:o(e.object,t)}},intermalTermToTurtle:function(e,t,r){if(u(e)){d.test(e)&&(e=e.replace(v,y));var n=Object.keys(r).find(t=>e.startsWith(r[t]));return n?n+e.substr(r[n].length):e.startsWith(t)?"<"+e.substr(t.length)+">":"<"+e+">"}if(l(e))return e;if(c(e)){var i=f(e),s=h(e),a=p(e);return d.test(i)&&(i=i.replace(v,y)),a?'"'+i+'"@'+a:s?'"'+i+'"^^'+this._encodeIriOrBlankNode(s):'"'+i+'"'}throw Error("Unknown internal term type: "+JSON.stringify(e))}}}();void 0!==e&&void 0!==r&&(t.exports=n)},{}],49:[function(t,r,n){var i=function(){var r=t("./RdfTerm");const n=t("hierarchy-closure"),i={_namespace:"http://www.w3.org/ns/shex#"};["Schema","@context","imports","startActs","start","shapes","ShapeOr","ShapeAnd","shapeExprs","nodeKind","NodeConstraint","iri","bnode","nonliteral","literal","datatype","length","minlength","maxlength","pattern","flags","mininclusive","minexclusive","maxinclusive","maxexclusive","totaldigits","fractiondigits","values","ShapeNot","shapeExpr","Shape","virtual","closed","extra","expression","inherit","semActs","ShapeRef","reference","ShapeExternal","EachOf","OneOf","expressions","min","max","annotation","TripleConstraint","inverse","negated","predicate","valueExpr","Inclusion","include","Language","languageTag","IriStem","LiteralStem","LanguageStem","stem","IriStemRange","LiteralStemRange","LanguageStemRange","exclusion","Wildcard","SemAct","name","code","Annotation","object"].forEach(e=>{i[e]=i._namespace+e});const s={_namespace:"http://www.w3.org/1999/02/22-rdf-syntax-ns#"};["type","first","rest","nil"].forEach(e=>{s[e]=s._namespace+e});const a={_namespace:"http://www.w3.org/2001/XMLSchema#"};["anyURI"].forEach(e=>{a[e]=a._namespace+e});const o={_namespace:"http://www.w3.org/2002/07/owl#"};["Thing"].forEach(e=>{o[e]=o._namespace+e});const u={};var c=-1;function l(e){e||(e={});for(var t,r=1,n=arguments.length;r<n&&(t=arguments[r]||{});r++)for(var i in t)e[i]=t[i];return e}function f(e){return"object"!=typeof e||"value"in e&&Object.keys(e).reduce((e,t)=>!1===e?e:-1!==["value","type","language"].indexOf(t),!0)}var h={SX:i,RDF:s,version:function(){return"0.5.0"},Visitor:function(){var e=this;var t={runtimeError:function(e){throw e},visitSchema:function(t){var r={type:"Schema"};return e._expect(t,"type","Schema"),this._maybeSet(t,r,"Schema",["prefixes","base","imports","startActs","start","shapes","productions"]),r},visitPrefixes:function(e){return void 0===e?void 0:(t=e,r=function(e){return e},n={},Object.keys(t).forEach(function(e){n[e]=r(t[e])}),n);var t,r,n},visitIRI:function(e){return e},visitImports:function(e){var t=this;return e.map(function(e){return t.visitIRI(e)})},visitStartActs:function(e){var t=this;return void 0===e?void 0:e.map(function(e){return t.visitSemAct(e)})},visitSemActs:function(e){var t=this;if(void 0!==e){var r=[];return Object.keys(e).forEach(function(n){r.push(t.visitSemAct(e[n],n))}),r}},visitSemAct:function(t,r){var n={type:"SemAct"};return e._expect(t,"type","SemAct"),this._maybeSet(t,n,"SemAct",["name","code"]),n},visitShapes:function(e){var t=this;if(void 0!==e){var r={};return Object.keys(e).forEach(function(n){r[n]=t.visitShapeExpr(e[n],n)}),r}},visitProductions:function(e){var t=this;if(void 0!==e){var r={};return Object.keys(e).forEach(function(n){r[n]=t.visitExpression(e[n],n)}),r}},visitShapeExpr:function(e,t){var r="Shape"===e.type?this.visitShape(e,t):"NodeConstraint"===e.type?this.visitNodeConstraint(e,t):"ShapeAnd"===e.type?this.visitShapeAnd(e,t):"ShapeOr"===e.type?this.visitShapeOr(e,t):"ShapeNot"===e.type?this.visitShapeNot(e,t):"ShapeRef"===e.type?this.visitShapeRef(e):"ShapeExternal"===e.type?this.visitShapeExternal(e):null;if(null===r)throw Error("unexpected shapeExpr type: "+e.type);return r},_visitShapeGroup:function(e,t){this._testUnknownAttributes(e,["id","shapeExprs"],e.type,this.visitShapeNot);var r=this,n={type:e.type};return"id"in e&&(n.id=e.id),n.shapeExprs=e.shapeExprs.map(function(e){return r.visitShapeExpr(e,t)}),n},visitShapeNot:function(e,t){this._testUnknownAttributes(e,["id","shapeExpr"],"ShapeNot",this.visitShapeNot);var r={type:e.type};return"id"in e&&(r.id=e.id),r.shapeExpr=this.visitShapeExpr(e.shapeExpr,t),r},visitShape:function(t,r){var n={type:"Shape"};return e._expect(t,"type","Shape"),this._maybeSet(t,n,"Shape",["id","closed","expression","extra","semActs","annotations"]),n},visitNodeConstraint:function(t,r){var n={type:"NodeConstraint"};return e._expect(t,"type","NodeConstraint"),this._maybeSet(t,n,"NodeConstraint",["id","nodeKind","datatype","pattern","flags","length","reference","minlength","maxlength","mininclusive","minexclusive","maxinclusive","maxexclusive","totaldigits","fractiondigits","values","annotations","semActs"]),n},visitShapeRef:function(e){return this._testUnknownAttributes(e,["reference"],"ShapeRef",this.visitShapeNot),{type:"ShapeRef",reference:e.reference}},visitShapeExternal:function(e){return this._testUnknownAttributes(e,["id"],"ShapeExternal",this.visitShapeNot),l("id"in e?{id:e.id}:{},{type:"ShapeExternal"})},_visitGroup:function(e,t){var r=this,n=Object.assign("id"in e?{id:null}:{},{type:e.type});return n.expressions=e.expressions.map(function(e){return r.visitExpression(e)}),this._maybeSet(e,n,"expr",["id","min","max","annotations","semActs"],["expressions"])},visitTripleConstraint:function(e){return this._maybeSet(e,Object.assign("id"in e?{id:null}:{},{type:"TripleConstraint"}),"TripleConstraint",["id","inverse","predicate","valueExpr","min","max","annotations","semActs"])},visitExpression:function(e){var t="TripleConstraint"===e.type?this.visitTripleConstraint(e):"OneOf"===e.type?this.visitOneOf(e):"EachOf"===e.type?this.visitEachOf(e):"Inclusion"===e.type?this.visitInclusion(e):null;if(null===t)throw Error("unexpected expression type: "+e.type);return t},visitValues:function(e){var t=this;return e.map(function(e){return f(e)||"Language"===e.type?e:t.visitStemRange(e)})},visitStemRange:function(t){var r=this;"type"in t||r.runtimeError(Error("expected "+JSON.stringify(t)+" to have a 'type' attribute."));var n,i=["IriStem","LiteralStem","LanguageStem","IriStemRange","LiteralStemRange","LanguageStemRange"];return-1===i.indexOf(t.type)&&r.runtimeError(Error("expected type attribute '"+t.type+"' to be in '"+i+"'.")),f(t)?(e._expect(t.stem,"type","Wildcard"),n={type:t.type,stem:{type:"Wildcard"}}):n={type:t.type,stem:t.stem},t.exclusions&&(n.exclusions=t.exclusions.map(function(e){return r.visitExclusion(e)})),n},visitExclusion:function(e){if(f(e))return e;"type"in e||_Visitor.runtimeError(Error("expected "+JSON.stringify(e)+" to have a 'type' attribute."));var t=["IriStem","LiteralStem","LanguageStem"];return-1===t.indexOf(e.type)&&_Visitor.runtimeError(Error("expected type attribute '"+e.type+"' to be in '"+t+"'.")),{type:e.type,stem:e.stem}},visitInclusion:function(t){var r={type:"Inclusion"};return e._expect(t,"type","Inclusion"),this._maybeSet(t,r,"Inclusion",["include"]),r},_maybeSet:function(e,t,r,n,i){var s=this;return this._testUnknownAttributes(e,i?n.concat(i):n,r,this._maybeSet),n.forEach(function(r){var n="visit"+r.charAt(0).toUpperCase()+r.slice(1);if(r in e){var i=s[n];if("function"!=typeof i)throw Error(n+" not found in Visitor");var a=i.call(s,e[r]);void 0!==a&&(t[r]=a)}}),t},_visitValue:function(e){return e},_visitList:function(e){return e.slice()},_testUnknownAttributes:function(e,t,r,n){var i=Object.keys(e).reduce(function(e,r){return"type"!==r&&-1===t.indexOf(r)?e.concat(r):e},[]);if(i.length>0){var s=Error("unknown propert"+(i.length>1?"ies":"y")+": "+i.map(function(e){return'"'+e+'"'}).join(",")+" in "+r+": "+JSON.stringify(e));throw Error.captureStackTrace(s,n),s}}};return t.visitBase=t.visitStart=t.visitVirtual=t.visitClosed=t._visitValue,t.visitInherit=t.visitExtra=t.visitAnnotations=t._visitList,t.visitInverse=t.visitPredicate=t._visitValue,t.visitName=t.visitId=t.visitCode=t.visitMin=t.visitMax=t._visitValue,t.visitType=t.visitNodeKind=t.visitDatatype=t.visitPattern=t.visitFlags=t.visitLength=t.visitMinlength=t.visitMaxlength=t.visitMininclusive=t.visitMinexclusive=t.visitMaxinclusive=t.visitMaxexclusive=t.visitTotaldigits=t.visitFractiondigits=t._visitValue,t.visitOneOf=t.visitEachOf=t._visitGroup,t.visitShapeAnd=t.visitShapeOr=t._visitShapeGroup,t.visitInclude=t._visitValue,t.visitValueExpr=t.visitShapeExpr,t},ShExJVisitor:function(e){var t=h.Visitor(),r=t.visitShapeExpr,n=t.visitShape,i=t.visitExpression;return t.visitShapeExpr=t.visitValueExpr=function(e,t){return"string"==typeof e?{type:"ShapeRef",reference:e}:r.call(this,e,t)},t.visitShape=function(e,t){var r=n.call(this,e,t);return"extra"in e&&r.extra.sort(),r},t.visitExpression=function(t){var r="string"==typeof t?{type:"Inclusion",include:t}:i.call(this,t);return"object"==typeof t&&"id"in t&&(e[t.id]=r),r},t},ShExJtoAS:function(e){var t=this;delete e["@context"];var r={};if("start"in e){var n=t.ShExJVisitor(r);e.start=n.visitShapeExpr(e.start)}if("shapes"in e){var i={};e.shapes.forEach(e=>{var n=e.id;delete e.id;var s=t.ShExJVisitor(r);i[n]=s.visitShapeExpr(e)}),e.shapes=i}return Object.keys(r).length>0&&(e.productions=r),e},AStoShExJ:function(e,t){t||(delete e.prefixes,delete e.base),delete e.productions,e["@context"]="http://www.w3.org/ns/shex.jsonld";var r=h.Visitor();if(r.visitShapeRef=function(e){return e.reference},r.visitInclusion=function(e){return e.include},"start"in e&&(e.start=r.visitShapeExpr(e.start)),"shapes"in e){var n=[];for(var i in e.shapes)n.push(Object.assign({id:i},r.visitShapeExpr(e.shapes[i])));e.shapes=n}return e},ShExRVisitor:function(e){var t=h.Visitor(),n={},i=t.visitShapeExpr,s=(t.visitValueExpr,t.visitExpression);return t.keepShapeExpr=i,t.visitShapeExpr=t.visitValueExpr=function(t,r){if("string"==typeof t)return t;if("id"in t){if(-1!==e.indexOf(t.id)||1===Object.keys(t).length)return t.id;delete t.id}return i.call(this,t,r)},t.visitExpression=function(e){if("string"==typeof e)return e;if("id"in e&&e.id in n)return n[e.id].refCount++,e.id;var t=s.call(this,e);return n[e.id]={refCount:1,expr:t},t},t.cleanIds=function(){for(var e in n){var t=n[e];1===t.refCount&&r.isBlank(t.expr.id)&&delete t.expr.id}},t},ShExRtoShExJ:function(e){var t=[];"shapes"in e&&(t=t.concat(e.shapes.map(e=>e.id)));var r=this.ShExRVisitor(t);return"start"in e&&(e.start=r.visitShapeExpr(e.start)),"shapes"in e&&(e.shapes=e.shapes.map(e=>r.keepShapeExpr(e))),r.cleanIds(),e},valGrep:function(e,t,r){var n=[];for(var i in e){var s=e[i];"object"==typeof s&&("type"in s&&s.type===t&&n.push(r(s)),n.push.apply(n,this.valGrep(s,t,r)))}return n},n3jsToTurtle:function(e){return this.valGrep(e,"TestedTriple",function(e){return["subject","predicate","object"].map(n=>"object"==typeof(t=e[n])?'"'+t.value+'"'+("type"in t?"^^<"+t.type+">":"language"in t?"@"+t.language:""):r.isIRI(t)?"<"+t+">":r.isBlank(t)?t:"???").join(" ")+" .";var t})},valToN3js:function(e){return this.valGrep(e,"TestedTriple",function(e){var t=JSON.parse(JSON.stringify(e));return"object"==typeof e.object&&(t.object='"'+e.object.value+'"'+("type"in e.object?"^^"+e.object.type:"language"in e.object?"@"+e.object.language:"")),t})},n3jsToTurtle:function(e){return e.map(function(e){return["subject","predicate","object"].map(t=>(function(e){if(r.isIRI(e))return"<"+e+">";if(r.isBlank(e))return e;var t=r.getLiteralType(e);return t&&"http://www.w3.org/2001/XMLSchema#string"!==t?'"'+r.getLiteralValue(e)+'"^^<'+t+">":e})(e[t])).join(" ")+" ."})},canonicalize:function(e,t){var r=JSON.parse(JSON.stringify(e));delete r.prefixes,delete r.base;var n=h.Visitor(),i=[],s=n.visitInclusion,a=n.visitExpression;return n.visitInclusion=function(t){return-1===i.indexOf(t.include)&&"productions"in e&&t.include in e.productions?(i.push(t.include),a.call(n,e.productions[t.include])):s.call(n,t)},n.visitExpression=function(t){return"id"in t?-1===i.indexOf(t.id)?(i.push(t.id),a.call(n,e.productions[t.id])):{type:"Inclusion",include:t.id}:a.call(n,t)},t&&(n.visitIRI=function(e){return e.replace(t,"")},"imports"in r&&(r.imports=n.visitImports(r.imports))),"shapes"in r&&Object.keys(r.shapes).sort().forEach(e=>{"extra"in r.shapes[e]&&r.shapes[e].extra.sort(),r.shapes[e]=n.visitShapeExpr(r.shapes[e])}),r},BiDiClosure:function(){return{needs:{},neededBy:{},inCycle:[],test:function(){function e(e,t){var r=JSON.stringify(e),n=JSON.stringify(t);if(r!==n)throw Error(r+" !== "+n)}this.add(2,3),e(this.needs,{2:[3]}),e(this.neededBy,{3:[2]}),this.add(1,2),e(this.needs,{1:[2,3],2:[3]}),e(this.neededBy,{3:[2,1],2:[1]}),this.add(1,3),e(this.needs,{1:[2,3],2:[3]}),e(this.neededBy,{3:[2,1],2:[1]}),this.add(3,4),e(this.needs,{1:[2,3,4],2:[3,4],3:[4]}),e(this.neededBy,{3:[2,1],2:[1],4:[3,2,1]}),this.add(6,7),e(this.needs,{6:[7],1:[2,3,4],2:[3,4],3:[4]}),e(this.neededBy,{7:[6],3:[2,1],2:[1],4:[3,2,1]}),this.add(5,6),e(this.needs,{5:[6,7],6:[7],1:[2,3,4],2:[3,4],3:[4]}),e(this.neededBy,{7:[6,5],6:[5],3:[2,1],2:[1],4:[3,2,1]}),this.add(5,7),e(this.needs,{5:[6,7],6:[7],1:[2,3,4],2:[3,4],3:[4]}),e(this.neededBy,{7:[6,5],6:[5],3:[2,1],2:[1],4:[3,2,1]}),this.add(7,8),e(this.needs,{5:[6,7,8],6:[7,8],7:[8],1:[2,3,4],2:[3,4],3:[4]}),e(this.neededBy,{7:[6,5],6:[5],8:[7,6,5],3:[2,1],2:[1],4:[3,2,1]}),this.add(4,5),e(this.needs,{1:[2,3,4,5,6,7,8],2:[3,4,5,6,7,8],3:[4,5,6,7,8],4:[5,6,7,8],5:[6,7,8],6:[7,8],7:[8]}),e(this.neededBy,{2:[1],3:[2,1],4:[3,2,1],5:[4,3,2,1],6:[5,4,3,2,1],7:[6,5,4,3,2,1],8:[7,6,5,4,3,2,1]})},add:function(e,t,r){var n=this;e in n.needs||(n.needs[e]=[]),t in n.neededBy||(n.neededBy[t]=[]),n.needs[e]=n.needs[e].concat([t],n.needs[t]).filter(function(e,t,r){return void 0!==e&&r.indexOf(e)===t}),n.neededBy[t]=n.neededBy[t].concat([e],n.neededBy[e]).filter(function(e,t,r){return void 0!==e&&r.indexOf(e)===t}),e in this.neededBy&&this.neededBy[e].forEach(function(e){n.needs[e]=n.needs[e].concat([t],n.needs[t]).filter(function(e,t,r){return void 0!==e&&r.indexOf(e)===t})}),t in this.needs&&this.needs[t].forEach(function(t){n.neededBy[t]=n.neededBy[t].concat([e],n.neededBy[e]).filter(function(e,t,r){return void 0!==e&&r.indexOf(e)===t})}),-1!==n.needs[e].indexOf(e)&&(n.inCycle=n.inCycle.concat(n.needs[e]))},trim:function(){function e(e){for(var t=e.length-1;t>-1;--t)e.indexOf(e[t])<t&&e.splice(t,t+1)}for(k in this.needs)e(this.needs[k]);for(k in this.neededBy)e(this.neededBy[k])},foundIn:{},addIn:function(e,t){this.foundIn[e]=t}}},nestShapes:function(e,t={}){var r=this;"no"in t||(t.no=!1);let n=Object.keys(e.shapes||[]),i={};n.forEach(t=>{let n=e.shapes[t];if(a(t,null),"Shape"===(n=r.skipDecl(n)).type)"extends"in n&&n.extends.forEach(e=>a(e,n)),"expression"in n&&(r.simpleTripleConstraints(n)||[]).forEach(e=>{a(r.getValueType(e.valueExpr,!0),{type:"tc",shapeLabel:t,tc:e})});else if("NodeConstraint"!==n.type)throw Error("nestShapes currently only supports Shapes and NodeConstraints")});let s=Object.keys(i).filter(t=>1===i[t].length&&"tc"===i[t][0].type&&"Shape"===r.skipDecl(e.shapes[t]).type).reduce((e,t)=>(e[t]={referrer:i[t][0].shapeLabel,predicate:i[t][0].tc.predicate},e),{});if(!t.no){let r={};if(t.rename){"transform"in t||(t.transform=function(){let e=n.reduce((e,t,r)=>(e[t]="_:transformed"+r,e),{});return function(t,r){return e[t]}}()),Object.keys(s).forEach(a=>{let o=e.shapes[a],u=t.transform(a,o);if(r[a]=u,n[n.indexOf(a)]=u,s[u]=s[a],s[u].was=a,delete s[a],e.shapes[u]=e.shapes[a],delete e.shapes[a],1!==i[a].length)throw Error("assertion: "+a+" doesn't have one reference: ["+i[a]+"]");let c=i[a][0];if("tc"!==c.type)throw"Shape"===c.type?Error("assertion: rename not implemented for Shape: "+c):Error("assertion: "+c.type+" not TripleConstraint or Shape");if("ShapeRef"!==c.tc.valueExpr.type)throw Error("assertion: rename not implemented for TripleConstraint expr: "+c.tc.valueExpr);c.tc.valueExpr.reference=u}),Object.keys(s).forEach(e=>{let t=s[e];t.referrer in r&&(t.newReferrer=r[t.referrer])});let a={};n.forEach(t=>a[t]=e.shapes[t]),e.shapes=a}else Object.keys(s).forEach(t=>{i[t][0].tc.valueExpr=e.shapes[t].shapeExpr,delete e.shapes[t]})}return s;function a(e,t){e in i||(i[e]=[]),t&&i[e].push(t)}},getPredicateUsage:function(e,t={}){var r=this;let i=n.create();Object.keys(e.shapes).forEach(t=>{let n=r.skipDecl(e.shapes[t]);"Shape"===n.type&&(n.extends||[]).forEach(e=>i.add(e,t))}),Object.keys(e.shapes).forEach(e=>{e in i.parents||(i.parents[e]=[])});let s={};return Object.keys(e.shapes).forEach(n=>{let a=r.skipDecl(e.shapes[n]);if("Shape"===a.type){(r.simpleTripleConstraints(a)||[]).forEach(e=>{let a=r.getValueType(e.valueExpr);if(e.predicate in s){s[e.predicate].uses.push(n);let r=s[e.predicate].commonType;if("object"==typeof r||null===r)t[e.predicate].references.push({shapeLabel:n,newType:a});else if("object"==typeof a)s[e.predicate].commonType=null,t[e.predicate]={shapeLabel:n,predicate:e.predicate,curType:r,newType:a,references:[]};else if(r===a);else if(-1!==i.parents[r].indexOf(a))s[e.predicate].polymorphic=!0;else{let o=i.parents[a].indexOf(r);if(-1===o){let o=i.parents[r].filter(e=>-1!==i.parents[a].indexOf(e));0===o.length?(t[e.predicate]={shapeLabel:n,predicate:e.predicate,curType:r,newType:a,references:[]},s[e.predicate].commonType=null):(s[e.predicate].commonType=o[0],s[e.predicate].polymorphic=!0)}else s[e.predicate].commonType=i.parents[a][o],s[e.predicate].polymorphic=!0}}else s[e.predicate]={uses:[n],commonType:a,polymorphic:!1},"object"==typeof a&&(t[e.predicate]={shapeLabel:n,predicate:e.predicate,newType:a,references:[]})})}}),s},simpleTripleConstraints:function(e){if(!("expression"in e))return[];if("TripleConstraint"===e.expression.type)return[e.expression];if("EachOf"===e.expression.type&&!e.expression.expressions.find(e=>"TripleConstraint"!==e.type))return e.expression.expressions;throw Error("can't (yet) express "+JSON.stringify(e))},skipDecl:function(e){return"ShapeDecl"===e.type?e.shapeExpr:e},getValueType:function(e){return"string"==typeof e?e:e.reference?e.reference:"iri"===e.nodeKind?o.Thing:e.datatype?e.datatype:e},getDependencies:function(e,t){return t=t||this.BiDiClosure(),Object.keys(e.shapes||[]).forEach(function(r){function n(e,i){if("ShapeOr"===e.type||"ShapeAnd"===e.type)e.shapeExprs.forEach(function(e){n(e,i)});else if("ShapeNot"===e.type)n(e.shapeExpr,1^i);else if("Shape"===e.type)!function(e,i){e.inherit&&e.inherit.length>0&&e.inherit.forEach(function(e){t.add(r,e)});e.expression&&function e(i,s){function a(t,r){t.forEach(function(t){e(t,r)})}"id"in i&&t.addIn(i.id,r);if("TripleConstraint"===i.type)!function(e,i){e.valueExpr&&n(e.valueExpr,i);if(i&&-1!==t.inCycle.indexOf(r))throw Error("Structural error: "+r+" appears in negated cycle")}(i,s);else if("OneOf"===i.type||"EachOf"===i.type)!function a(e,i){e.forEach(function(e){!function e(i,s){function a(t,r){t.forEach(function(t){e(t,r)})}"id"in i&&t.addIn(i.id,r);if("TripleConstraint"===i.type)!function(e,i){e.valueExpr&&n(e.valueExpr,i);if(i&&-1!==t.inCycle.indexOf(r))throw Error("Structural error: "+r+" appears in negated cycle")}(i,s);else if("OneOf"===i.type||"EachOf"===i.type)a(i.expressions);else{if("Inclusion"!==i.type)throw Error("expected {TripleConstraint,OneOf,EachOf,Inclusion} in "+i);t.add(r,i.include)}}(e,i)})}(i.expressions);else{if("Inclusion"!==i.type)throw Error("expected {TripleConstraint,OneOf,EachOf,Inclusion} in "+i);t.add(r,i.include)}}(e.expression,i)}(e,i);else if("NodeConstraint"===e.type);else if("ShapeRef"===e.type)t.add(r,e.reference);else if("ShapeExternal"!==e.type)throw Error("expected Shape{And,Or,Ref,External} or NodeConstraint in "+util.inspect(e))}n(e.shapes[r],0)}),t},partition:function(e,t,r,n){t=t instanceof Array?t:[t],r=r||this.getDependencies(e),n=n||function(e,t){throw new Error("Error: can't find shape "+(t?t+" dependency "+e:e))};var i={};for(var s in e)i[s]="shapes"===s?{}:e[s];return t.forEach(function(t){t in e.shapes?(i.shapes[t]=e.shapes[t],t in r.needs&&r.needs[t].forEach(function(s){if(s in e.shapes)i.shapes[s]=e.shapes[s];else if(s in e.productions){var a=r.foundIn[s];i.shapes[a]=e.shapes[a],i.productions[s]=e.productions[s]}else n(s,t)})):n(t)}),i},flatten:function(e,t,r){return this.Visitor().visitSchema(e)},emptySchema:function(){return{type:"Schema"}},merge:function(e,t,r,n){var i,s=n?e:this.emptySchema();return"productions"in e&&(s.productions=e.productions),"productions"in t&&("productions"in e&&!r||(s.productions=t.productions)),"base"in e&&(s.base=e.base),"base"in t&&("base"in e&&!r||(s.base=t.base)),i="prefixes",Object.keys(e[i]||{}).forEach(function(t){i in s||(s[i]={}),s[i][t]=e[i][t]}),Object.keys(t[i]||{}).forEach(function(n){i in e&&n in e[i]&&!r||(i in s||(s[i]={}),s[i][n]=t[i][n])}),"imports"in t&&("imports"in e&&!r||(s.imports=t.imports)),"startActs"in e&&(s.startActs=e.startActs),"startActs"in t&&("startActs"in e&&!r||(s.startActs=t.startActs)),"start"in e&&(s.start=e.start),"start"in t&&("start"in e&&!r||(s.start=t.start)),Object.keys(e.shapes||{}).forEach(function(t){"shapes"in s||(s.shapes={}),s.shapes[t]=e.shapes[t]}),Object.keys(t.shapes||{}).forEach(function(n){"shapes"in e&&n in e.shapes&&!r||("shapes"in s||(s.shapes={}),s.shapes[n]=t.shapes[n])}),s},absolutizeResults:function(e,t){function n(e,n){-1!==["shape","reference","node","subject","predicate","object"].indexOf(e)&&r.isIRI(n[e])&&(n[e]=r.resolveRelativeIRI(t,n[e]))}return function e(t){Object.keys(t).forEach(function(r){"object"==typeof t[r]&&e(t[r]),n&&n(r,t)})}(e),e},validateSchema:function(e){var t=this.Visitor(),r=currentExtra=null,i=!1,s=!1,a=t.visitShape,o=n.create(),u=n.create();t.visitShape=function(e,r){var n=currentExtra;currentExtra=e.extra;var i=a.call(t,e,r);return currentExtra=n,i};var c=t.visitShapeNot;t.visitShapeNot=function(e,r){var n=i;i^=!0;var s=c.call(t,e,r);return i=n,s};var l=t.visitTripleConstraint;t.visitTripleConstraint=function(e){var r=i;currentExtra&&-1!==currentExtra.indexOf(e.predicate)&&(i^=!0),s=!0;var n=l.call(t,e);return s=!1,i=r,n};var f=t.visitShapeRef;t.visitShapeRef=function(n){if(!(n.reference in e.shapes))throw Error("Structural error: reference to "+JSON.stringify(n)+" not found in schema shape expressions:\n"+d(e.shapes)+".");if(!s&&n.reference===r)throw Error("Structural error: circular reference to "+r+".");return(i?o:u).add(r,n.reference),f.call(t,n)};var h=t.visitInclusion;t.visitInclusion=function(r){if(!("productions"in e&&e.productions[r.include]))throw Error("Structural error: included shape "+r.include+" not found in schema triple expressions:\n"+d(e.productions)+".");return h.call(t,r)},Object.keys(e.shapes||[]).forEach(function(n){r=n,t.visitShapeExpr(e.shapes[n],n)});let p=Object.keys(o.children).filter(e=>o.children[e].filter(t=>t in o.children&&-1!==o.children[t].indexOf(e)||t in u.children&&-1!==u.children[t].indexOf(e)).length>0);if(p.length)throw Error("Structural error: circular negative dependencies on "+p.join(",")+".");function d(e){return e?Object.keys(e).map(e=>"_:"===e.substr(0,2)?e:"<"+e+">").join("\n        "):"- none defined -"}},isWellDefined:function(e){return this.validateSchema(e),e},walkVal:function(e,t){var r=this;if("NodeTest"===e.type)return null;if("ShapeTest"===e.type)return"solution"in e?r.walkVal(e.solution,t):null;if("ShapeOrResults"===e.type)return r.walkVal(e.solution,t);if("EachOfSolutions"===e.type||"OneOfSolutions"===e.type)return e.solutions.reduce((e,n)=>(n.expressions.forEach(n=>{var i=r.walkVal(n,t);i&&Object.keys(i).forEach(t=>{e[t]=t in e?e[t].concat(i[t]):i[t]})}),e),{});if("OneOfSolutions"===e.type)return e.solutions.reduce((e,n)=>(Object.assign(e,r.walkVal(n,t)),e),{});if("TripleConstraintSolutions"===e.type){if("solutions"in e){var n={},i=[];return n[e.predicate]=i,e.solutions.forEach(e=>{var n=[];if(function e(n){if(!n)return!1;if(n.node===s.nil)return!0;if("solution"in n&&"solutions"in n.solution&&1===n.solution.solutions.length&&"expressions"in n.solution.solutions[0]&&2===n.solution.solutions[0].expressions.length&&"predicate"in n.solution.solutions[0].expressions[0]&&n.solution.solutions[0].expressions[0].predicate===s.first&&n.solution.solutions[0].expressions[1].predicate===s.rest){var a=n.solution.solutions[0].expressions,o=a[0],u=a[1].solutions[0],c=o.solutions[0],l=t(c);if("referenced"in c){var f=r.walkVal(c.referenced,t);f&&(l.nested=f)}return i.push(l),u.object===s.nil||e(u.referenced)}}(e.referenced))i=i.concat(n);else{var a=t(e);if("referenced"in e){var o=r.walkVal(e.referenced,t);o&&(a.nested=o)}i.push(a)}}),i.length?n:null}return null}if("Recursion"===e.type)return null;throw Error("unknown shapeExpression type in "+JSON.stringify(e))},valToValues:function(e){return this.walkVal(e,function(e){return{ldterm:e.object}})},valToExtension:function(e,t){return function e(r){var n=[],i={};function s(e){if(null===i)return e;if(e.constructor===Array)return i=null,e;for(a in e){if(a in i)return i=null,e;i[a]=e[a]}return e}for(var a in r)if("extensions"===a)r[a]&&n.push(s(r[a][t]));else if("nested"===a){var o=e(r[a]);o.constructor===Array?o.forEach(s):s(o),n=n.concat(o)}else n.push(s(e(r[a])));return 1===n.length?n[0]:i||n}(this.walkVal(e,function(e){return{extensions:e.extensions}}))},valuesToSchema:function(e){var t=e;if(e[s.type][0].ldterm===i.Schema){var r={"@context":"http://www.w3.org/ns/shex.jsonld",type:"Schema"};i.startActs in t&&(r.startActs=t[i.startActs].map(e=>{var t={type:"SemAct",name:e.nested[i.name][0].ldterm};return i.code in e.nested&&(t.code=e.nested[i.code][0].ldterm.value),t})),i.imports in t&&(r.imports=t[i.imports].map(e=>e.ldterm)),e[i.start]&&(r.start=l({id:e[i.start][0].ldterm},o(e[i.start][0].nested)));var n=e[i.shapes];return n&&(r.shapes=n.map(e=>l({id:e.ldterm},o(e.nested)))),r}throw Error("unknown schema type in "+JSON.stringify(e));function a(e,t,r){var n=e[s.type][0].ldterm.substr(i._namespace.length),a=t[n];if(!a)return u;if(a.nary)return(o={type:n})[a.prop]=e[i[a.prop]].map(e=>c(e)),o;var o={type:n};return a.prop&&(o[a.prop]=c(e[i[a.prop]][0])),o;function c(e){return a.expr&&"nested"in e?l({id:e.ldterm},r(e.nested)):e.ldterm}}function o(e){if((r=a(e,{ShapeAnd:{nary:!0,expr:!0,prop:"shapeExprs"},ShapeOr:{nary:!0,expr:!0,prop:"shapeExprs"},ShapeNot:{nary:!1,expr:!0,prop:"shapeExpr"},ShapeRef:{nary:!1,expr:!1,prop:"reference"},ShapeExternal:{nary:!1,expr:!1,prop:null}},o))!==u)return r;var t=e[s.type][0].ldterm;if(t===i.Shape){var r={type:"Shape"};return["closed"].forEach(t=>{i[t]in e&&(r[t]=!!e[i[t]][0].ldterm.value)}),i.extra in e&&(r.extra=e[i.extra].map(e=>e.ldterm)),i.expression in e&&(r.expression="nested"in e[i.expression][0]?l({id:e[i.expression][0].ldterm},f(e[i.expression][0].nested)):e[i.expression][0].ldterm),i.annotation in e&&(r.annotations=e[i.annotation].map(e=>({type:"Annotation",predicate:e.nested[i.predicate][0].ldterm,object:e.nested[i.object][0].ldterm}))),i.semActs in e&&(r.semActs=e[i.semActs].map(e=>{var t={type:"SemAct",name:e.nested[i.name][0].ldterm};return i.code in e.nested&&(t.code=e.nested[i.code][0].ldterm.value),t})),r}if(t===i.NodeConstraint){r={type:"NodeConstraint"};return i.values in e&&(r.values=e[i.values].map(e=>(function e(t,r){if("nested"in t){var n=t.nested[s.type][0].ldterm;if(-1!==[i.IriStem,i.LiteralStem,i.LanguageStem].indexOf(n)){var a=t.nested[i.stem][0].ldterm.value;return{type:n.substr(i._namespace.length),stem:a}}if(-1!==[i.Language].indexOf(n))return{type:"Language",languageTag:t.nested[i.languageTag][0].ldterm.value};if(-1!==[i.IriStemRange,i.LiteralStemRange,i.LanguageStemRange].indexOf(n)){var o=t.nested[i.stem][0],u=o;"object"==typeof o&&("object"==typeof o.ldterm?u=o.ldterm:o.ldterm.startsWith("_:")&&(u={type:"Wildcard"}));var c={type:n.substr(i._namespace.length),stem:"Wildcard"!==u.type?u.value:u};return i.exclusion in t.nested&&(c.exclusions=t.nested[i.exclusion].map(t=>e(t,n!==i.IriStemRange))),c}throw Error("unknown objectValue type in "+JSON.stringify(t))}return r?t.ldterm.value:t.ldterm})(e))),i.nodeKind in e&&(r.nodeKind=e[i.nodeKind][0].ldterm.substr(i._namespace.length)),["length","minlength","maxlength","mininclusive","maxinclusive","minexclusive","maxexclusive","totaldigits","fractiondigits"].forEach(t=>{i[t]in e&&(r[t]=parseFloat(e[i[t]][0].ldterm.value))}),i.pattern in e&&(r.pattern=e[i.pattern][0].ldterm.value),i.flags in e&&(r.flags=e[i.flags][0].ldterm.value),i.datatype in e&&(r.datatype=e[i.datatype][0].ldterm),r}throw Error("unknown shapeExpr type in "+JSON.stringify(e))}function f(e){if((t=a(e,{EachOf:{nary:!0,expr:!0,prop:"expressions"},OneOf:{nary:!0,expr:!0,prop:"expressions"},Inclusion:{nary:!1,expr:!1,prop:"include"}},f))!==u)return h(e,t),t;if(e[s.type][0].ldterm===i.TripleConstraint){var t={type:"TripleConstraint",predicate:e[i.predicate][0].ldterm};return["inverse"].forEach(r=>{i[r]in e&&(t[r]=!!e[i[r]][0].ldterm.value)}),i.valueExpr in e&&(t.valueExpr=l({id:e[i.valueExpr][0].ldterm},"nested"in e[i.valueExpr][0]?o(e[i.valueExpr][0].nested):{})),h(e,t),t}throw Error("unknown tripleExpr type in "+JSON.stringify(e))}function h(e,t){return i.min in e&&(t.min=parseInt(e[i.min][0].ldterm.value)),i.max in e&&(t.max=parseInt(e[i.max][0].ldterm.value),isNaN(t.max)&&(t.max=c)),i.annotation in e&&(t.annotations=e[i.annotation].map(e=>({type:"Annotation",predicate:e.nested[i.predicate][0].ldterm,object:e.nested[i.object][0].ldterm}))),i.semActs in e&&(t.semActs=e[i.semActs].map(e=>{var t={type:"SemAct",name:e.nested[i.name][0].ldterm};return i.code in e.nested&&(t.code=e.nested[i.code][0].ldterm.value),t})),t}},valToSimple:function(e){var t,r=this;function n(e){return e.reduce((e,t)=>(Object.keys(t).forEach(r=>{e[r]=r in e?Array.from(new Set(e[r].concat(t[r]))):t[r]}),e),{})}if("TripleConstraintSolutions"===e.type)return"solutions"in e?e.solutions.reduce((e,t)=>{if(!("referenced"in t))return{};var i={};return function e(t){if(!t)return!1;if(t.node===s.nil)return!0;if("solution"in t&&"solutions"in t.solution&&1===t.solution.solutions.length&&"expressions"in t.solution.solutions[0]&&2===t.solution.solutions[0].expressions.length&&"predicate"in t.solution.solutions[0].expressions[0]&&t.solution.solutions[0].expressions[0].predicate===s.first&&t.solution.solutions[0].expressions[1].predicate===s.rest){var a=t.solution.solutions[0].expressions,o=a[0],u=a[1].solutions[0],c=o.solutions[0],l={ldterm:c.object};if("referenced"in c){var f=r.valToSimple(c.referenced);f&&(l.nested=f)}return i=n(i),u.object===s.nil||e(u.referenced)}}(t.referenced)?n(e):n(e,r.valToSimple(t.referenced))},[]):[];if(-1!==["TripleConstraintSolutions"].indexOf(e.type))return{};if("NodeTest"===e.type)return(t={})[p(e.node)]=[e.shape],t;if("ShapeTest"===e.type)return(t={})[p(e.node)]=[e.shape],"solution"in e?n([t].concat(r.valToSimple(e.solution))):t;if("Recursion"===e.type)return{};if("solutions"in e)return n(e.solutions.map(e=>r.valToSimple(e)));if("expressions"in e)return n(e.expressions.map(e=>r.valToSimple(e)));throw Error("unknown shapeExpression type in "+JSON.stringify(e))},simpleToShapeMap:function(e){return Object.keys(e).reduce((t,r)=>(e[r].forEach(e=>{t.push({node:r,shape:e})}),t),[])},absolutizeShapeMap:function(e,t){return e.map(e=>Object.assign(e,{node:r.resolveRelativeIRI(t,e.node),shape:r.resolveRelativeIRI(t,e.shape)}))},errsToSimple:function(r,n,i){var s=this;if("FailureList"===r.type)return r.errors.reduce((e,t)=>e.concat(s.errsToSimple(t)),[]);if("Failure"===r.type)return["validating "+r.node+" as "+r.shape+":"].concat(function e(t){return t.reduce(function(t,r){var n=Object.keys(r);return t.concat(1===n.length&&"errors"===n[0]?e(r.errors):r)},[])}(r.errors).reduce((e,t)=>{var r=s.errsToSimple(t).map(e=>"  "+e);return e.length>0?e.concat(["  OR"]).concat(r):r.map(e=>"  "+e)},[]));if("TypeMismatch"===r.type){var a=r.errors.constructor===Array?r.errors.reduce((e,t)=>e.concat(("string"==typeof t?[t]:s.errsToSimple(t)).map(e=>"  "+e)),[]):"  "+("string"==typeof e?[r.errors]:s.errsToSimple(r.errors));return["validating "+p(r.triple.object)+":"].concat(a)}if("ShapeAndFailure"===r.type)return r.errors.constructor===Array?r.errors.reduce((e,t)=>e.concat(("string"==typeof t?[t]:s.errsToSimple(t)).map(e=>"  "+e)),[]):"  "+("string"==typeof e?[r.errors]:s.errsToSimple(r.errors));if("ShapeOrFailure"===r.type)return r.errors.constructor===Array?r.errors.reduce((e,t)=>e.concat(" OR "+("string"==typeof t?[t]:s.errsToSimple(t))),[]):" OR "+("string"==typeof e?[r.errors]:s.errsToSimple(r.errors));if("ShapeNotFailure"===r.type)return["Node "+r.errors.node+" expected to NOT pass "+r.errors.shape];if("ExcessTripleViolation"===r.type)return["validating "+p(r.triple.object)+": exceeds cardinality"];if("ClosedShapeViolation"===r.type)return["ClosedShapeError: unexpected: {"].concat(r.unexpectedTriples.map(e=>"  "+e.subject+" "+e.predicate+" "+p(e.object)+" .")).concat(["}"]);if("NodeConstraintViolation"===r.type){var o,u=t("../lib/ShExWriter")();return u._write(u._writeNodeConstraint(r.shapeExpr).join("")),u.end((e,t)=>{o=t}),["NodeConstraintError: expected to match "+o]}if("MissingProperty"===r.type)return["Missing property: "+r.property];if("NegatedProperty"===r.type)return["Unexpected property: "+r.property];if(r.constructor===Array)return r.reduce((e,t)=>{var r=s.errsToSimple(t).map(e=>"  "+e);return e.length?e.concat(["AND"]).concat(r):r},[]);throw Error("unknown shapeExpression type in "+JSON.stringify(r))},resolveRelativeIRI:r.resolveRelativeIRI,resolvePrefixedIRI:function(e,t){var r=e.indexOf(":");if(-1===r)return null;var n=t[e.substr(0,r)];return void 0===n?null:n+e.substr(r+1)},parsePassedNode:function(e,t,n,i,s){if(void 0===e||0===e.length)return i&&i(t.base)?t.base:n?n():this.NotSupplied;if("_"===e[0]&&":"===e[1])return e;if('"'===e[0]){var a=e.match(/^"((?:[^"\\]|\\")*)"(?:@(.+)|\^\^(?:<(.*)>|([^:]*):(.*)))?$/);if(!a)throw Error("malformed literal: "+e);var o=a[1],u=a[2],c=a[3],l=a[4],f=a[5],h='"'+o+'"';if(void 0!==u)return h+"@"+u;if(void 0!==l){if(!(l in t.prefixes))throw Error("error parsing node "+e+' no prefix for "'+l+'"');return h+"^^"+t.prefixes[l]+f}return void 0!==c?h+"^^"+r.resolveRelativeIRI(t.base,c):h}if(!t)return i(e)?e:this.UnknownIRI;var p="<"===e[0]&&">"===e[e.length-1];p&&(e=e.substr(1,e.length-2));var d=r.resolveRelativeIRI(t.base||"",e);if(i(d))return d;if(!p){var v=this.resolvePrefixedIRI(e,t.prefixes);if(null!==v&&i(v))return v}return s?s(d):this.UnknownIRI},executeQueryPromise:function(e,t){var r=t+"?query="+encodeURIComponent(e);return fetch(r,{headers:{Accept:"application/sparql-results+json"}}).then(e=>e.json()).then(e=>{var t=e.head.vars;return e.results.bindings.map(e=>t.map(t=>{var r=e[t];switch(r.type){case"uri":return r.value;case"bnode":return"_:"+r.value;case"literal":var n=r.datatype,i=r["xml:lang"];return'"'+r.value+'"'+(n?"^^"+n:i?"@"+i:"");default:throw"unknown XML results type: "+r.prop("tagName")}return e[t]}))})},executeQuery:function(e,t){var r=t+"?query="+encodeURIComponent(e),n=new XMLHttpRequest;n.open("GET",r,!1),n.setRequestHeader("Accept","application/sparql-results+json"),n.send();var i,s=(i=JSON.parse(n.responseText)).head.vars;return i.results.bindings.map(e=>s.map(t=>{var r=e[t];switch(r.type){case"uri":return r.value;case"bnode":return"_:"+r.value;case"literal":var n=r.datatype,i=r["xml:lang"];return'"'+r.value+'"'+(n?"^^"+n:i?"@"+i:"");default:throw"unknown XML results type: "+r.prop("tagName")}return e[t]}))},makeN3DB:function(e,t){return{getNeighborhood:function(n,i){var s;t&&(s=new Date,t.start(!1,n,i));var a=e.getQuads(n,null,null,null).map(r.internalTriple);if(t){var o=new Date;t.end(a,o-s),s=o}t&&t.start(!0,n,i);var u=e.getQuads(null,null,n,null).map(r.internalTriple);return t&&t.end(u,new Date-s),{outgoing:a,incoming:u}},getSubjects:function(){return e.getSubjects().map(r.internalTerm)},getPredicates:function(){return e.getPredicates().map(r.internalTerm)},getObjects:function(){return e.getObjects().map(r.internalTerm)},getQuads:function(){return e.getQuads.apply(e,arguments).map(r.internalTriple)},get size(){return e.size}}},makeQueryDB:function(e,t){var r=this;function n(t,n,i){return r.executeQuery(t,e).map(e=>n?{subject:n,predicate:e[0],object:e[1]}:{subject:e[0],predicate:e[1],object:i})}return{getNeighborhood:function(e,i,s){var a,o,u,c,l=(o=s.expression,u=r.Visitor(),c={out:[],inc:[]},u.visitTripleConstraint=function(e){return c[e.inverse?"inc":"out"].push(e),e},o&&u.visitExpression(o),c),f=l.out.map(e=>e.predicate);f=f.filter((e,t)=>f.lastIndexOf(e)===t),t&&(a=new Date,t.start(!1,e,i));var h=l.out.length>0||s.closed?n(s.closed?`SELECT ?p ?o { <${e}> ?p ?o }`:"SELECT ?p ?o {\n"+f.map(t=>`  {<${e}> <${t}> ?o BIND(<${t}> AS ?p)}`).join(" UNION\n")+"\n}",e,null):[];if(t){var p=new Date;t.end(h,p-a),a=p}t&&t.start(!0,e,i);var d=l.inc.length>0?n(`SELECT ?s ?p { ?s ?p <${e}> }`,null,e):[];return t&&t.end(d,new Date-a),{outgoing:h,incoming:d}},getQuads:function(e,t,r,i){return n("SELECT "+[e?"":"?s",t?"":"?p",r?"":"?o","{",e||"?s",t||"?s",r||"?s","}"].join(" "),e,r)},getSubjects:function(){return["!Query DB can't index subjects"]},getPredicates:function(){return["!Query DB can't index predicates"]},getObjects:function(){return["!Query DB can't index objects"]},get size(){}}},NotSupplied:"-- not supplied --",UnknownIRI:"-- not found --",_expect:function(e,t,r){t in e||this._error("expected "+JSON.stringify(e)+" to have a ."+t),arguments.length>2&&e[t]!==r&&this._error("expected "+e[e]+" to equal ."+r)},_error:function(e){throw new Error(e)},unescapeText:function(e,t){try{return e=e.replace(/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\(.)/g,function(e,r,n,i){var s;if(r){if(s=parseInt(r,16),isNaN(s))throw new Error;return String.fromCharCode(s)}if(n){if(s=parseInt(n,16),isNaN(s))throw new Error;return s<65535?String.fromCharCode(s):String.fromCharCode(55296+((s-=65536)>>10),56320+(1023&s))}var a=t[i];if(!a)throw new Error("no replacement found for '"+i+"'");return a})}catch(e){return console.warn(e),""}}};function p(e){if("object"!=typeof e)return e;var t='"'+e.value+'"';return"language"in e?t+"@"+e.language:"type"in e?t+"^^"+e.type:t}function d(e,t){for(var r in h)t?e.prototype[r]=v(h[r]):e[r]=h[r];return e}function v(e){return function(t){return e(this,t)}}return d(d)}();void 0!==t&&void 0!==n&&(r.exports=i)},{"../lib/ShExWriter":51,"./RdfTerm":48,"hierarchy-closure":54}],50:[function(e,t,r){(function(n){var i=function(){var t=-1,r={term:"START"},i="VERBOSE"in n.env,s=e("./RdfTerm");function a(e){return s.isIRI(e)?e:s.isLiteral(e)?s.getLiteralValue(e):e.substr(2)}var o="http://www.w3.org/2001/XMLSchema#",u=[o+"integer",o+"nonPositiveInteger",o+"negativeInteger",o+"long",o+"int",o+"short",o+"byte",o+"nonNegativeInteger",o+"unsignedLong",o+"unsignedInt",o+"unsignedShort",o+"unsignedByte",o+"positiveInteger"],c=[o+"decimal"].concat(u),l=[o+"float",o+"double"].concat(c),f={};f[o+"integer"]=function(e,t){return e.match(/^[+-]?[0-9]+$/)||t("illegal integer value '"+e+"'"),parseInt(e)},f[o+"decimal"]=function(e,t){return e.match(/^[+-]?(?:[0-9]*\.[0-9]+|[0-9]+)$/)||t("illegal decimal value '"+e+"'"),parseFloat(e)};const h=/^[+\-]?(?:[0-9]+(?:\.[0-9]*)?|\.[0-9]+)(?:[eE][+\-]?[0-9]+)?$/;f[o+"float"]=function(e,t){return"NaN"===e?NaN:"INF"===e?1/0:"-INF"===e?-1/0:(e.match(h)||t("illegal float value '"+e+"'"),parseFloat(e))},f[o+"double"]=function(e,t){return"NaN"===e?NaN:"INF"===e?1/0:"-INF"===e?-1/0:(e.match(h)||t("illegal double value '"+e+"'"),Number(e))},testRange=function(e,t,r){var n={integer:{min:-1/0,max:1/0},decimal:{min:-1/0,max:1/0},float:{min:-1/0,max:1/0},double:{min:-1/0,max:1/0},nonPositiveInteger:{min:-1/0,max:0},negativeInteger:{min:-1/0,max:-1},long:{min:-0x8000000000000000,max:0x8000000000000000},int:{min:-2147483648,max:2147483647},short:{min:-32768,max:32767},byte:{min:-128,max:127},nonNegativeInteger:{min:0,max:1/0},unsignedLong:{min:0,max:0x10000000000000000},unsignedInt:{min:0,max:4294967295},unsignedShort:{min:0,max:65535},unsignedByte:{min:0,max:255},positiveInteger:{min:1,max:1/0}}[t.substr(o.length)];if(!n)throw Error("unexpected datatype: "+t);e<n.min?r('"'+e+'"^^<'+t+"> is less than the min:",n.min):e>n.max&&r('"'+e+'"^^<'+t+"> is greater than the max:",n.min)};var p={length:function(e,t){return e.length===t},minlength:function(e,t){return e.length>=t},maxlength:function(e,t){return e.length<=t}},d={mininclusive:function(e,t){return e>=t},minexclusive:function(e,t){return e>t},maxinclusive:function(e,t){return e<=t},maxexclusive:function(e,t){return e<t}},v={totaldigits:function(e,t){var r=e.match(/[0-9]/g);return r&&r.length<=t},fractiondigits:function(e,t){var r=e.match(/^[+-]?[0-9]*\.?([0-9]*)$/);return r&&r[1].length<=t}};function g(e){if('"'!==e[0])return e;var t={value:s.getLiteralValue(e)},r=s.getLiteralType(e);r&&"http://www.w3.org/2001/XMLSchema#string"!==r&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"!==r&&(t.type=r);var n=s.getLiteralLanguage(e);return n&&(t.language=n),t}function y(e){return"object"!=typeof e||"value"in e&&Object.keys(e).reduce((e,t)=>!1===e?e:-1!==["value","type","language"].indexOf(t),!0)}var m=function(){function e(e){return s.isLiteral(e)?-1!==["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#float","http://www.w3.org/2001/XMLSchema#double"].indexOf(s.getLiteralType(e))?parseInt(s.getLiteralValue(e)):e:s.isBlank(e)?e:"<"+e+">"}return e(this.subject)+" "+e(this.predicate)+" "+e(this.object)+" ."};function b(e){return{byPredicate:e.reduce(function(e,t){var r=t.predicate;return r in e||(e[r]=[]),e[r].push(t),i&&(t.toString=m),e},{}),candidates:x(e.length).map(function(){return[]}),misses:[]}}function _(e,t){var[r,n]=[e,t].map(e=>s.isBlank(e)?1:s.isLiteral(e)?2:3);return r===n?e.localeCompare(t):r-n}function x(e){return 0===e?[]:Array(e).join(" ").split(/ /)}function w(e,t,r){t in e||E("expected "+JSON.stringify(e)+" to have a '"+t+"' attribute."),arguments.length>2&&e[t]!==r&&E("expected "+t+" attribute '"+e[t]+"' to equal '"+r+"'.")}function S(){}function E(){var e=Array.prototype.join.call(arguments,""),t=new Error(e);throw Error.captureStackTrace(t,E),t}return{construct:function n(c,h){if(!(this instanceof n))return new n(c,h);this.type="ShExValidator",h=h||{},this.options=h,this.options.or=this.options.or||"someOf",this.options.partition=this.options.partition||"exhaustive","noCache"in h&&h.noCache||(this.known={});var m=this;this.schema=c,this._expect=this.options.lax?S:w,this._optimize={},this.reset=function(){};var j=this.options.regexModule||e("../lib/regex/threaded-val-nerr");this.getAST=function(){return{type:"AST",shapes:Object.keys(this.schema.shapes).reduce(function(e,r){return e[r]={type:"ASTshape",expression:function(e,r,n){function i(){this.type="Epsilon"}function s(e){this.type="Choice",this.disjuncts=e}function a(e){this.type="EachOf",this.conjuncts=e}function o(e,t){this.type="SemActs",this.expression=e,this.semActs=t}return e?function e(n,u){var c,l;function f(e,r,n){if(void 0===r&&(r=1),void 0===n&&(n=1),1===r&&1===n)return e;var o=n===t?new function(e){this.type="KleeneStar",this.expression=e}(e):x(n-r).reduce(function(t,r,n){return new s(0===n?[e,new i]:[new a([e,t]),new i])},void 0),u=0!==r?new a(x(r).map(function(t){return e}).concat(o)):o;return u}if("TripleConstraint"===n.type){var h="valueExprRef"in n?u.valueExprDefns[n.valueExprRef]:n.valueExpr,p=r.push(n)-1,d=new function(e,t,r,n,i){this.type="TripleConstraint",this.inverse=!!r,this.negated=!!n,this.predicate=t,void 0!==i&&(this.valueExpr=i)}(p,n.predicate,n.inverse,n.negated,h);return c=f(d,n.min,n.max),n.semActs?new o(c,n.semActs):c}if("OneOf"===n.type)return l=new s(n.expressions.map(function(t){return e(t,u)})),c=f(l,n.min,n.max),n.semActs?new o(c,n.semActs):c;if("EachOf"===n.type)return l=new a(n.expressions.map(function(t){return e(t,u)})),c=f(l,n.min,n.max),n.semActs?new o(c,n.semActs):c;if("Inclusion"===n.type){var v=u.shapes[n.include].expression;return e(v,u)}throw Error("unexpected expr type: "+n.type)}(e,n):new i}(m.schema.shapes[r].expression,[],m.schema)},e},{})}},this.indexTripleConstraints=function(e){var t=[];return e&&function e(r){"TripleConstraint"===r.type?t.push(r):"OneOf"===r.type||"EachOf"===r.type?r.expressions.forEach(function(t){e(t)}):"Inclusion"===r.type?e(c.productions[r.include]):E("unexpected expr type: "+r.type)}(e),t},this.emptyTracker=function(){var e=e=>e;return{recurse:e,known:e,enter:function(e,t){++this.depth},exit:function(e,t,r){--this.depth},depth:0}},this.validate=function(e,t,n,i,s){if("object"==typeof t){var a=t;if("api"===this.options.results)return a.map(t=>{var r=new Date,s=this.validate(e,t.node,t.shape,n,i);return r=new Date-r,{node:t.node,shape:t.shape,status:"errors"in s?"nonconformant":"conformant",appinfo:s,elapsed:r}});var o=a.reduce((t,r)=>{var n=this.validate(e,r.node,r.shape,i,s);return"errors"in n?{passes:t.passes,failures:t.failures.concat(n)}:{passes:t.passes.concat(n),failures:t.failures}},{passes:[],failures:[]});return o.failures.length?1!==o.failures.length?{type:"FailureList",errors:o.failures}:o.failures[0]:1!==o.passes.length?{type:"SolutionList",solutions:o.passes}:o.passes[0]}var u=void 0===i;i||(i=this.emptyTracker()),n&&n!==r||c.start||E("start production not defined");var l=null;n==r?l=c.start:"shapes"in this.schema&&0!==this.schema.shapes.length?n in this.schema.shapes?l=c.shapes[n]:E("shape "+n+" not found in:\n"+Object.keys(this.schema.shapes||[]).map(e=>"  "+e).join("\n")):E("shape "+n+" not found; no shapes in schema"),void 0===s&&(s={});var f=t+"@"+(n===r?"_: -start-":n);if(f in s)return i.recurse({type:"Recursion",node:g(t),shape:n});if("known"in this&&f in this.known)return i.known(this.known[f]);s[f]={point:t,shape:n},i.enter(t,n);var h=this._validateShapeExpr(e,t,l,n,i,s);return i.exit(t,n,h),delete s[f],"known"in this&&(this.known[f]=h),"startActs"in c&&u&&(h.startActs=c.startActs),h},this._validateShapeExpr=function(e,t,r,n,i,s){if(""===t)throw Error("validation needs a valid focus node");if("NodeConstraint"===r.type)return(a=this._errorsMatchingNodeConstraint(t,r,null)).length?{type:"Failure",node:g(t),shape:n,errors:a.map(function(e){return{type:"NodeConstraintViolation",shapeExpr:r,error:e}})}:{type:"NodeTest",node:g(t),shape:n,shapeExpr:r};if("Shape"===r.type)return this._validateShape(e,t,j.compile(c,r),r,n,i,s);if("ShapeRef"===r.type)return this._validateShapeExpr(e,t,c.shapes[r.reference],r.reference,i,s);if("ShapeExternal"===r.type)return this.options.validateExtern(e,t,n,i,s);if("ShapeOr"===r.type){for(var a=[],o=0;o<r.shapeExprs.length;++o){var u=r.shapeExprs[o];if(!("errors"in(f=this._validateShapeExpr(e,t,u,n,i,s))))return{type:"ShapeOrResults",solution:f};a.push(f)}return{type:"ShapeOrFailure",errors:a}}if("ShapeNot"===r.type)return"errors"in(f=this._validateShapeExpr(e,t,r.shapeExpr,n,i,s))?{type:"ShapeNotResults",solution:f}:{type:"ShapeNotFailure",errors:f};if("ShapeAnd"===r.type){var l=[];for(o=0;o<r.shapeExprs.length;++o){var f;if(u=r.shapeExprs[o],"errors"in(f=this._validateShapeExpr(e,t,u,n,i,s)))return{type:"ShapeAndFailure",errors:[f]};l.push(f)}return{type:"ShapeAndResults",solutions:l}}throw Error("expected one of Shape{Ref,And,Or} or NodeConstraint, got "+JSON.stringify(r))},this._validateShape=function(e,t,r,n,s,a,o){var u=this,l=null;if("startActs"in c&&!this.semActHandler.dispatchAll(c.startActs,null,{}))return{type:"Failure",node:g(t),shape:s,errors:["semact failure"]};for(var f=e.getNeighborhood(t,s,n),h=b(f.outgoing.sort((e,t)=>_(e.object,t.object))),p=b(f.incoming.sort((e,t)=>_(e.subject,t.subject))),d=f.outgoing.length,v=f.outgoing.concat(f.incoming),y=this.indexTripleConstraints(n.expression),m=y.reduce(function(t,r,n){r.inverse,r.inverse;var i=(r.inverse?p:h).byPredicate[r.predicate]||[],c=u._triplesMatchingShapeExpr(i,r.valueExpr,r.inverse,function(t,r){var n=u.validate(e,t,r,a,o);return"errors"in n?n.errors:[]},function(t,r){var n=u._validateShapeExpr(e,t,r,s,a,o);return"errors"in n?n.errors:[]});return c.hits.forEach(function(e){t.constraintList[v.indexOf(e)].push(n)}),c.misses.forEach(function(e){t.misses[v.indexOf(e.triple)]={constraintNo:n,errors:e.errors}}),t},{misses:{},constraintList:x(v.length).map(function(){return[]})}),w=[],S=m.constraintList.reduce(function(e,t,r){return 0===t.length&&r<d&&r in m.misses&&(void 0!==n.extra&&-1!==n.extra.indexOf(v[r].predicate)?w.push(r):e.push({tripleNo:r,constraintNo:m.misses[r].constraintNo,errors:m.misses[r].errors})),e},[]),E=function(e){var t=e.length,r=[],n=null;return{next:function(){if(null!==n&&0===n.length)return!1;if(null===n)return function(){n=[];for(var i=0;i<t;i++)r[i]=0,n[i]=e[i][0]}(),!0;var i=t-1;if(r[i]++,r[i]<e[i].length)return n[i]=e[i][r[i]],!0;for(;r[i]>=e[i].length;){if(0==i)return!1;r[i]=0,n[i]=e[i][0],r[--i]++}return n[i]=e[i][r[i]],!0},do:function(e,t){return e.apply(t,n)},get:function(){return n}}}(m.constraintList),j=[];0===S.length&&E.next()&&null===l;){var k=[],O=x(v.length).map(function(){return 0}),I=E.get();if(n.closed){var T=v.slice(0,d).filter((e,t)=>void 0===I[t]&&-1===w.indexOf(t));if(T.length>0){j.push({errors:[{type:"ClosedShapeViolation",unexpectedTriples:T}]});continue}}function A(){var e=y.length;return I.slice().reduce(function(e,t,r){return void 0!==t&&e[t].push(r),e},x(e).map(function(){return[]}))}function N(t,r){return u.validate(e,t,r,a,o)}function R(t,r){return u._validateShapeExpr(e,t,r,s,a,o)}function L(e,t,r,n){return u._errorsMatchingShapeExpr(e,t,r,n)}I.forEach(function(e,t){void 0!==e&&(k.push(v[t]),++O[e])}),I.slice().sort(function(e,t){return e-t}).filter(function(e){return void 0!==e}).map(function(e){return e+" "}).join("");var C=r.match(e,t,y,A(),I,v,N,R,this.semActHandler,L,null);if("errors"in C){if(j.push({errors:C.errors}),"exhaustive"!==u.options.partition)break}else{var B={type:"ShapeTest",node:g(t),shape:s};if(Object.keys(C).length>0&&(B.solution=C),"semActs"in n&&!this.semActHandler.dispatchAll(n.semActs,C,B)){if(j.push({errors:[{type:"SemActFailure",errors:[{type:"UntrackedSemActFailure"}]}]}),"exhaustive"!==u.options.partition)break}else l=B}}if(null===l){var M=S.map(function(e){var t=v[e.tripleNo];return{type:"TypeMismatch",triple:{type:"TestedTriple",subject:t.subject,predicate:t.predicate,object:g(t.object)},constraint:y[e.constraintNo],errors:e.errors}});l={type:"Failure",node:g(t),shape:s,errors:M.concat(1===j.length?j[0].errors:j)}}return i&&v.forEach(function(e){delete e.toString}),function(e){return"annotations"in n&&(e.annotations=n.annotations),e}(l)},this._triplesMatchingShapeExpr=function(e,t,r,n,i){var s=this,a=[],o=[];return e.forEach(function(e){var u=r?e.subject:e.object,c=void 0===t?[]:s._errorsMatchingShapeExpr(u,t,n,i);0===c.length?o.push(e):-1===o.indexOf(e)&&a.push({triple:e,errors:c})}),{hits:o,misses:a}},this._errorsMatchingShapeExpr=function(e,t,r,n){var i=this;if("NodeConstraint"===t.type)return this._errorsMatchingNodeConstraint(e,t,null);if("Shape"===t.type)return void 0===n?[]:n(e,t);if("ShapeRef"===t.type)return r?r(e,t.reference):[];if("ShapeOr"===t.type){for(var s=[],a=0;a<t.shapeExprs.length;++a){var o=i._errorsMatchingShapeExpr(e,t.shapeExprs[a],r,n);if(0===o.length)return o;s=s.concat(o)}return s}if("ShapeAnd"===t.type)return t.shapeExprs.reduce(function(t,s,a){return t.concat(i._errorsMatchingShapeExpr(e,s,r,n,!0))},[]);if("ShapeNot"===t.type)return(s=i._errorsMatchingShapeExpr(e,t.shapeExpr,r,n,!0)).length?[]:["Error validating "+e+" as "+JSON.stringify(t)+": expected NOT to pass"];throw Error("unknown value expression type '"+t.type+"'")},this._errorsMatchingNodeConstraint=function(e,t,r){var n=[],i=s.isLiteral(e)?s.getLiteralValue(e):s.isBlank(e)?e.substring(2):e,c=s.isLiteral(e)?s.getLiteralType(e):null,h=-1!==u.indexOf(c)?o+"integer":-1!==l.indexOf(c)?c:void 0;function m(){var r=Array.prototype.join.call(arguments,"");return n.push("Error validating "+e+" as "+JSON.stringify(t)+": "+r),!1}if("nodeKind"in t&&(-1===["iri","bnode","literal","nonliteral"].indexOf(t.nodeKind)&&m("unknown node kind '"+t.nodeKind+"'"),s.isBlank(e)?"iri"!==t.nodeKind&&"literal"!==t.nodeKind||m("blank node found when "+t.nodeKind+" expected"):s.isLiteral(e)?"literal"!==t.nodeKind&&m("literal found when "+t.nodeKind+" expected"):"bnode"!==t.nodeKind&&"literal"!==t.nodeKind||m("iri found when "+t.nodeKind+" expected")),t.datatype&&t.values&&m("found both datatype and values in "+tripleConstraint),t.datatype&&(s.isLiteral(e)?s.getLiteralType(e)!==t.datatype?m("mismatched datatype: "+s.getLiteralType(e)+" !== "+t.datatype):h?testRange(f[h](i,m),t.datatype,m):t.datatype===o+"boolean"?"true"!==i&&"false"!==i&&"1"!==i&&"0"!==i&&m("illegal boolean value: "+i):t.datatype===o+"dateTime"&&(i.match(/^[+-]?\d{4}-[01]\d-[0-3]\dT[0-5]\d:[0-5]\d:[0-5]\d(\.\d+)?([+-][0-2]\d:[0-5]\d|Z)?$/)||m("illegal dateTime value: "+i)):m("mismatched datatype: "+e+" is not a literal with datatype "+t.datatype)),t.values&&(s.isLiteral(e)&&t.values.reduce((t,r)=>{if(t)return!0;var n=g(e);return"Language"===r.type?r.languageTag===n.language:"object"==typeof r&&"value"in r&&r.value===n.value&&r.type===n.type&&r.language===n.language},!1)||-1!==t.values.indexOf(e)||t.values.some(function(t){if("object"==typeof t&&!("value"in t)){"type"in t||E("expected "+JSON.stringify(t)+" to have a 'type' attribute.");var r=["Language","IriStem","LiteralStem","LanguageStem","IriStemRange","LiteralStemRange","LanguageStemRange"];function n(e,r,n){return s.isLiteral(e)?-1!==["LiteralStem","LiteralStemRange"].indexOf(t.type)?n(s.getLiteralValue(e),r):-1!==["LanguageStem","LanguageStemRange"].indexOf(t.type)?n(s.getLiteralLanguage(e)||null,r):m("literal "+e+" not comparable with non-literal "+r):-1===["IriStem","IriStemRange"].indexOf(t.type)?m("nonliteral "+e+" not comparable with literal "+JSON.stringify(r)):n(e,r)}function i(e,r){return n(e,r,(e,r)=>"LanguageStem"===t.type||"LanguageStemRange"===t.type?null!==e&&(e===r||""===r||"-"===e[r.length]):e.startsWith(r))}if(-1===r.indexOf(t.type)&&E("expected type attribute '"+t.type+"' to be in '"+r+"'."),y(t.stem)){if(!i(e,t.stem))return!1}else w(t.stem,"type","Wildcard");return!t.exclusions||!t.exclusions.some(function(t){if(y(t))return n(e,t,(e,t)=>e===t);"type"in t||E("expected "+JSON.stringify(t)+" to have a 'type' attribute.");var r=["IriStem","LiteralStem","LanguageStem"];return-1===r.indexOf(t.type)&&E("expected type attribute '"+t.type+"' to be in '"+r+"'."),i(e,t.stem)})}})||m("value "+e+" not found in set "+JSON.stringify(t.values))),"pattern"in t){var b="flags"in t?new RegExp(t.pattern,t.flags):new RegExp(t.pattern);a(e).match(b)||m("value "+a(e)+" did not match pattern "+t.pattern)}return Object.keys(p).forEach(function(r){r in t&&!p[r](i,t[r])&&m("facet violation: expected "+r+" of "+t[r]+" but got "+e)}),Object.keys(d).forEach(function(r){r in t&&(h?d[r](f[h](i,m),t[r])||m("facet violation: expected "+r+" of "+t[r]+" but got "+e):m("facet violation: numeric facet "+r+" can't apply to "+e))}),Object.keys(v).forEach(function(r){r in t&&(h===o+"integer"||h===o+"decimal"?v[r](""+f[h](i,m),t[r])||m("facet violation: expected "+r+" of "+t[r]+" but got "+e):m("facet violation: numeric facet "+r+" can't apply to "+e))}),n},this.semActHandler={handlers:{},results:{},register:function(e,t){this.handlers[e]=t},dispatchAll:function(e,t,r){var n=this;return e.reduce(function(e,i){if(e&&i.name in n.handlers){var s="code"in i?i.code:m.options.semActs[i.name],a="extensions"in r&&i.name in r.extensions,o=a?r.extensions[i.name]:{};return e=e&&n.handlers[i.name].dispatch(s,t,o),!a&&Object.keys(o).length>0&&("extensions"in r||(r.extensions={}),r.extensions[i.name]=o),e}return e},!0)}}},start:r,options:{or:{oneOf:"exactly one disjunct must pass",someOf:"one or more disjuncts must pass",firstOf:"disjunct evaluation stops after one passes"},partition:{greedy:"each triple constraint consumes all triples matching predicate and object",exhaustive:"search all mappings of triples to triple constriant"}}}}();void 0!==e&&void 0!==r&&(t.exports=i)}).call(this,e("_process"))},{"../lib/regex/nfax-val-1err":52,"../lib/regex/threaded-val-nerr":53,"./RdfTerm":48,_process:27}],51:[function(e,t,r){var n=function(){var t=e("util"),r=-1,n=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,i=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,s={"\\":"\\\\",'"':'\\"',"/":"\\/","\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"},a={iri:"IRI",bnode:"BNODE",literal:"LITERAL",nonliteral:"NONLITERAL"};function o(e,t){if(!(this instanceof o))return new o(e,t);if(e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var r="";this._outputStream={write:function(e,t,n){r+=e,n&&n()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),this._error=t.error||l,this.forceParens=!t.simplifyParentheses,this._expect=t.lax?h:f}function u(e){var t=s[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}function c(e){return e.replace(/\\/g,"\\\\").replace(/%/g,"\\%")}function l(e,t){"function"!=typeof e&&(t=e,e=l);var r=new Error(t);throw Error.captureStackTrace(r,e),r}function f(e,t,r){t in e||this._error(f,"expected "+e+" to have a ."+t),arguments.length>2&&e[t]!==r&&this._error(f,"expected "+e[e]+" to equal ."+r)}function h(){}return o.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeSchema:function(e,t){var r=this;this._expect(e,"type","Schema"),r.addPrefixes(e.prefixes),e.base&&r._write("BASE "+this._encodeIriOrBlankNode(e.base)+"\n"),e.imports&&e.imports.forEach(function(e){r._write("IMPORT "+r._encodeIriOrBlankNode(e)+"\n")}),e.startActs&&e.startActs.forEach(function(e){r._expect(e,"type","SemAct"),r._write(" %"+r._encodePredicate(e.name)+("code"in e?"{"+c(e.code)+"%}":"%"))}),e.start&&r._write("start = "+r._writeShapeExpr(e.start,t,!0,0).join("")+"\n"),"shapes"in e&&Object.keys(e.shapes).forEach(function(n){r._write(r._encodeShapeName(n,!1)+" "+r._writeShapeExpr(e.shapes[n],t,!0,0).join("")+"\n",t)})},_writeShapeExpr:function(e,r,n,i){var s=this,a=[];if("ShapeRef"===e.type)a.push("@",s._encodeShapeName(e.reference));else if("ShapeExternal"===e.type)a.push("EXTERNAL");else if("ShapeAnd"===e.type){i>=3&&a.push("(");var o=!1;e.shapeExprs.forEach(function(t,n){if(n>0){function i(t){let r=e.shapeExprs[t];return!("NodeConstraint"!==r.type||"nodeKind"in r&&"literal"===r.nodeKind||"datatype"in r||"values"in r)}let t=!o&&(i(n-1)&&function(t){let r=e.shapeExprs[t];return"Shape"===r.type||"ShapeRef"===r.type}(n)||(u=n-1,"Shape"===e.shapeExprs[u].type&&i(n)));t||a.push(" AND "),o=t}var u;a=a.concat(s._writeShapeExpr(t,r,!1,3))}),i>=3&&a.push(")")}else if("ShapeOr"===e.type)i>=2&&a.push("("),e.shapeExprs.forEach(function(e,t){t>0&&a.push(" OR "),a=a.concat(s._writeShapeExpr(e,r,n,2))}),i>=2&&a.push(")");else if("ShapeNot"===e.type)i>=4&&a.push("("),a.push("NOT "),a=a.concat(s._writeShapeExpr(e.shapeExpr,r,n,4)),i>=4&&a.push(")");else if("Shape"===e.type)a=a.concat(s._writeShape(e,r,n));else{if("NodeConstraint"!==e.type)throw Error("expected Shape{,And,Or,Ref} or NodeConstraint in "+t.inspect(e));a=a.concat(s._writeNodeConstraint(e,r,n))}return a},_writeShape:function(e,t,n){var i,s=this;try{var a=[];this._expect(e,"type","Shape"),e.closed&&a.push("CLOSED "),e.extra&&e.extra.length>0&&(a.push("EXTRA "),e.extra.forEach(function(e,t){a.push(s._encodeShapeName(e,!1)+" ")}),a.push(" "));function o(e,t){0===e&&1===t?a.push("?"):0===e&&t===r?a.push("*"):void 0===e&&void 0===t||(1===e&&t===r?a.push("+"):a.push("{",e,",",t===r?"*":t,"}"))}return a.push("{\n"),e.expression&&function e(r,n,i){function u(e){e&&e.forEach(function(e){s._expect(e,"type","SemAct"),a.push("\n"+n+"   %"),a.push(s._encodeValue(e.name)),"code"in e?a.push("{"+c(e.code)+"%}"):a.push("%")})}function l(t,r,s,o){var u=s<i||o;u&&a.push("("),t.forEach(function(i,o){e(i,n+"  ",s),o<t.length-1&&a.push(r)}),u&&a.push(")")}if("id"in r&&(a.push("$"),a.push(s._encodeIriOrBlankNode(r.id,!0))),"TripleConstraint"===r.type)r.inverse&&a.push("^"),r.negated&&a.push("!"),a.push(n,s._encodePredicate(r.predicate)," "),"valueExpr"in r?a=a.concat(s._writeShapeExpr(r.valueExpr,t,!0,0)):a.push(". "),o(r.min,r.max),s._annotations(a,r.annotations,n),u(r.semActs);else if("OneOf"===r.type){var f="id"in r||"min"in r||"max"in r||"annotations"in r||"semActs"in r;l(r.expressions,"\n"+n+"| ",1,f||s.forceParens),o(r.min,r.max),s._annotations(a,r.annotations,n),u(r.semActs)}else if("EachOf"===r.type)f="id"in r||"min"in r||"max"in r||"annotations"in r||"semActs"in r,l(r.expressions,";\n"+n,2,f||s.forceParens),o(r.min,r.max),s._annotations(a,r.annotations,n),u(r.semActs);else{if("Inclusion"!==r.type)throw Error("unexpected expr type: "+r.type);a.push("&"),a.push(s._encodeShapeName(r.include,!1))}}(e.expression,"  ",0),a.push("\n}"),(i=e.semActs)&&i.forEach(function(e){s._expect(e,"type","SemAct"),a.push(" %",s._encodePredicate(e.name),"code"in e?"{"+c(e.code)+"%}":"%")}),s._annotations(a,e.annotations,"  "),a}catch(e){t&&t(e)}},_writeNodeConstraint:function(e,t){try{this._expect(e,"type","NodeConstraint");var r=[];return e.nodeKind in a?r.push(a[e.nodeKind]," "):void 0!==e.nodeKind&&this._error("unexpected nodeKind: "+e.nodeKind),this._fillNodeConstraint(r,e,t),this._annotations(r,e.annotations,"  "),r}catch(e){t&&t(e)}},_annotations:function(e,t,r){var n=this;t&&t.forEach(function(t){n._expect(t,"type","Annotation"),e.push("//\n"+r+"   "),e.push(n._encodeValue(t.predicate)),e.push(" "),e.push(n._encodeValue(t.object))})},_fillNodeConstraint:function(e,t,r){var n=this;if(t.datatype&&t.values&&n._error("found both datatype and values in "+expr),t.datatype&&e.push(n._encodeShapeName(t.datatype)),t.values&&(e.push("["),t.values.forEach(function(t,r){if(r>0&&e.push(" "),o(t))e.push(n._encodeValue(t));else{"type"in t||runtimeError("expected "+JSON.stringify(t)+" to have a 'type' attribute.");var s=["Language","IriStem","LiteralStem","LanguageStem","IriStemRange","LiteralStemRange","LanguageStemRange"];function a(e,t){return-1!==["LanguageStem","LanguageStemRange"].indexOf(e.type)?"@"+t:-1!==["LiteralStem","LiteralStemRange"].indexOf(e.type)?'"'+t.replace(i,t)+'"':n._encodeValue(t)}-1===s.indexOf(t.type)&&runtimeError("expected type attribute '"+t.type+"' to be in '"+s+"'."),"Language"===t.type?e.push("@"+t.languageTag):o(t.stem)?e.push(a(t,t.stem)+"~"):(f(t.stem,"type","Wildcard"),e.push(".")),t.exclusions&&t.exclusions.forEach(function(r){if(e.push(" - "),o(r))e.push(a(t,r));else{"type"in r||runtimeError("expected "+JSON.stringify(r)+" to have a 'type' attribute.");var n=["IriStem","LiteralStem","LanguageStem"];-1===n.indexOf(r.type)&&runtimeError("expected type attribute '"+r.type+"' to be in '"+n+"'."),e.push(a(t,r.stem)+"~")}})}}),e.push("]")),"pattern"in t){var s=t.pattern.replace(/\//g,"\\/"),a="flags"in t?t.flags:"";e.push("/"+s+"/"+a+" ")}return["length","minlength","maxlength","mininclusive","minexclusive","maxinclusive","maxexclusive","totaldigits","fractiondigits"].forEach(function(r){t[r]&&e.push(" ",r," ",t[r])}),e;function o(e){return"object"!=typeof e||"value"in e&&Object.keys(e).reduce((e,t)=>!1===e?e:-1!==["value","type","language"].indexOf(t),!0)}},_encodeIriOrBlankNode:function(e,t){if(t=t?" ":"","_"===e[0]&&":"===e[1])return e;n.test(e)&&(e=e.replace(i,u));var r=this._prefixRegex.exec(e);return r?(r[1]?this._prefixIRIs[r[1]]+r[2]:e)+t:"<"+e+">"},_encodeLiteral:function(e,t,r){return n.test(e)&&(e=e.replace(i,u)),r?'"'+e+'"@'+r:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeShapeName:function(e,t){if('"'===e[0])throw new Error("A literal as subject is not allowed: "+e);return this._encodeIriOrBlankNode(e,t)},_encodePredicate:function(e){if('"'===e[0])throw new Error("A literal as predicate is not allowed: "+e);return"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?"a":this._encodeIriOrBlankNode(e)},_encodeValue:function(e){return"object"!=typeof e?this._encodeIriOrBlankNode(e):this._encodeLiteral(e.value,e.type,e.language)},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},writeSchema:function(e,t){this._writeSchema(e,t),this.end(t)},addShape:function(e,t,r){this._write(_ShExWriter._encodeShapeName(t,!1)+" "+_ShExWriter._writeShapeExpr(e,r,!0,0).join(""),r)},addShapes:function(e){for(var t=0;t<e.length;t++)this.addShape(e[t])},addPrefix:function(e,t,r){var n={};n[e]=t,this.addPrefixes(n,r)},addPrefixes:function(e,t){var r=this._prefixIRIs,n=!1;for(var i in e){var s=e[i];r[s]!==(i+=":")&&(n=!0,r[s]=i,this._write("PREFIX "+i+" <"+s+">\n"))}if(n){var a="",o="";for(var u in r)a+=a?"|"+u:u,o+=(o?"|":"")+r[u];a=a.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+o+")[^/]*$|^("+a+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(n?"\n":"",t)},_prefixRegex:/$0^/,end:function(e){this._write=this._blockedWrite;var t=e&&function(r,n){t=null,e(r,n)};if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}},o}();void 0!==e&&void 0!==r&&(t.exports=n)},{util:47}],52:[function(e,t,r){var n=function(){var t=e("../RdfTerm"),n="<span class='keyword' title='Split'>|</span>",i="<span class='keyword' title='Repeat'></span>",s="<span class='keyword' title='Match'></span>",a=-1;function o(e){e||(e={});for(var t,r=1,n=arguments.length;r<n&&(t=arguments[r]||{});r++)for(var i in t)e[i]=t[i];return e}return r={name:"nfax-val-1err",description:"simple regular expression engine with n out states",compile:function(e,r){var u=r.expression;return function(){var t=[],r=h(s,[]),o=r;if(u){var l=function r(s,o){var u,c,f;function d(e,r){return void 0!=s.min&&1!==s.min||void 0!=s.max&&1!==s.max?(u=h(i,[e]),t[u].expr=s,t[u].min="min"in s?s.min:1,t[u].max="max"in s?s.max===a?1/0:s.max:1,p(r,u),{start:u,tail:[u]}):{start:e,tail:r}}if("TripleConstraint"===s.type)return u=h(s,[]),t[u].stack=o,{start:u,tail:[u]};if("OneOf"===s.type)return f=[],c=[],s.expressions.forEach(function(e,t){l=r(e,o.concat({c:s,e:t})),c.push(l.start),f=f.concat(l.tail)}),u=h(n,c),t[u].expr=s,d(u,f);if("EachOf"===s.type)return s.expressions.forEach(function(e,t){l=r(e,o.concat({c:s,e:t})),0===t?u=l.start:p(f,l.start),f=l.tail}),d(u,f);if("Inclusion"===s.type){var v=e.productions[s.include];return r(v,o)}throw Error("unexpected expr type: "+s.type)}(u,[]);p(l.tail,r),o=l.start}var f={algorithm:"rbenx",end:r,states:t,start:o,match:c};return r=t=o=null,f;function h(e,r,n){var i=t.length;return t.push({c:e,outs:r}),n&&(t[i].negated=!0),i}function p(e,r){e.forEach(e=>{t[e].outs.push(r)})}}();function c(r,n,i,s,u,c,d,v,g,y,m){var b=this,_=[],x=[];function w(e){return e.map(e=>{var t=b.states[e.state];return renderAtom(t.c,t.negated)})}if(1===b.states.length)return p([],0,c,d,v,g,y);var S=null;for(f(b,_,this.start,{repeats:{},avail:[],matched:[],stack:[],errors:[]});_.length;){x=[],m&&m.push({threads:[]});for(var E=0;E<_.length;++E){var j=_[E];if(j.state!==b.end){var k=b.states[j.state],O=x.length,I=i.indexOf(k.c),T="min"in k.c?k.c.min:1,A="max"in k.c?k.c.max===a?1/0:k.c.max:1;"negated"in k.c&&k.c.negated&&(T=A=0),void 0===j.avail[I]&&(j.avail[I]=s[I].slice());var N=j.avail[I].splice(0,A);if(N.length>=T)do{l(b,x,j,N)}while(j.avail[I].length>0&&N.length<A&&(N.push(j.avail[I].shift()),1));m&&m[m.length-1].threads.push({state:_[E].state,to:x.slice(O).map(e=>h(e.state,e.repeats))})}}if(0===x.length&&null===S)return C(w(b.states));var R=_;_=x,x=R;var L=_.reduce((e,t)=>{var r=t.matched.reduce((e,t)=>e+t.triples.length,0)===u.reduce((e,t)=>void 0===t?e:e+1,0);return null!==e?e:t.state===b.end&&r?t:null},null);L&&(S=L)}if(null===S)return C();function C(){return{type:"Failure",node:n,errors:w(b.states)}}function w(){return _.map(r=>{var n=o({},b.states[r.state].c.valueExpr);if("reference"in n){var i=n.reference;t.isBlank(i)&&(n.reference=e.shapes[i])}return o({type:k.c.negated?"NegatedProperty":r.state===b.end?"ExcessTripleViolation":"MissingProperty",property:k.c.predicate},Object.keys(n).length>0?{valueExpr:n}:{})})}return"errors"in S.matched?S.matched:p(S.matched,0,c,d,v,g,y)}function l(e,t,r,n){var s=e.states[r.state],a=e.states.map(e=>e.c===i?e.expr:null),o=s.stack.map(e=>{var t=r.repeats[a.indexOf(e.c)];return void 0===t?t=0:t-=1,{c:e.c,e:e.e,i:t}}),u={c:s.c,triples:n,stack:o};r.matched=r.matched.concat(u),s.outs.forEach(n=>{f(e,t,n,r)})}function f(e,t,r,s,a){a=a||[];var o=h(r,s.repeats);if(-1===a.indexOf(o)){a.push(o);var u=e.states[r];if(u.c===n)return u.outs.reduce((r,n,i)=>r.concat(f(e,t,n,s,a)),[]);if(u.c===i){var c=[];r in s.repeats||(s.repeats[r]=0);var l=s.repeats[r];return l<u.max&&(c=c.concat(f(e,t,u.outs[0],function(e,t){var r=Object.keys(e.repeats).reduce((r,n)=>(r[n]=parseInt(n)==t?e.repeats[n]+1:e.repeats[n],r),{});return{state:e.state,repeats:r,matched:e.matched,avail:e.avail.slice(),stack:e.stack}}(s,r),a))),l>=u.min&&l<=u.max&&(c=c.concat(f(e,t,u.outs[1],function(e,t){var r=Object.keys(e.repeats).reduce((r,n)=>(parseInt(n)!==t&&(r[n]=e.repeats[n]),r),{});return{state:e.state,repeats:r,matched:e.matched,avail:e.avail.slice(),stack:e.stack}}(s,r),a))),c}return[t.push({state:r,repeats:s.repeats,avail:s.avail.map(e=>e.slice()),stack:s.stack,matched:s.matched,errors:s.errors})-1]}}function h(e,t){var r=Object.keys(t).map(e=>e+":"+t[e]).join(",");return r.length?e+"-"+r:""+e}function p(e,n,i,s,a,o,u){var c=[],l=[],f=[],h=e.reduce((e,r)=>{for(var n,p=0,d=e;p<c.length&&r.stack[p].c===c[p].c&&r.stack[p].i===c[p].i&&r.stack[p].e===c[p].e;)d=d.solutions[c[p].i].expressions[c[p].e],++p;for(;p<r.stack.length;){if(p>=c.length&&c.push({}),r.stack[p].c!==c[p].c){if(n=[],d.type="EachOf"===r.stack[p].c.type?"EachOfSolutions":"OneOfSolutions",d.solutions=n,"min"in r.stack[p].c&&(d.min=r.stack[p].c.min),"max"in r.stack[p].c&&(d.max=r.stack[p].c.max),"annotations"in r.stack[p].c&&(d.annotations=r.stack[p].c.annotations),"semActs"in r.stack[p].c&&(d.semActs=r.stack[p].c.semActs),d=n,c[p].i=null,"semActs"in r.stack[p].c&&!o.dispatchAll(r.stack[p].c.semActs,"???",d))throw{type:"SemActFailure",errors:[{type:"UntrackedSemActFailure"}]};h&&"semActs"in expr&&(h.semActs=expr.semActs)}else d=d.solutions;if(r.stack[p].i!==c[p].i?(n=[],d[r.stack[p].i]={type:"EachOf"===r.stack[p].c.type?"EachOfSolution":"OneOfSolution",expressions:n},d=n,c[p].e=null):d=d[c[p].i].expressions,r.stack[p].e===c[p].e)throw"how'd we get here?";n={},d[r.stack[p].e]=n,r.stack[p].e>0&&void 0===d[r.stack[p].e-1]&&-1===f.indexOf(d)&&f.push(d),d=n,c.length=p+1,++p}return d.type="TripleConstraintSolutions","min"in r.c&&(d.min=r.c.min),"max"in r.c&&(d.max=r.c.max),d.predicate=r.c.predicate,"valueExpr"in r.c&&(d.valueExpr=r.c.valueExpr),"productionLabel"in r.c&&(d.productionLabel=r.c.productionLabel),d.solutions=r.triples.map(e=>{var n=i[e],c={type:"TestedTriple",subject:n.subject,predicate:n.predicate,object:function(e){if('"'!==e[0])return e;var r={value:t.getLiteralValue(e)},n=t.getLiteralType(e);n&&"http://www.w3.org/2001/XMLSchema#string"!==n&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"!==n&&(r.type=n);var i=t.getLiteralLanguage(e);return i&&(r.language=i),r}(n.object)};function f(e,r,n){var i=n(e,r);if("errors"in i){var s={type:"ReferenceError",focus:e,shape:r,errors:i};return"string"==typeof shapeLabel&&t.isBlank(shapeLabel)&&(s.referencedShape=r),[s]}return("solution"in i&&0!==Object.keys(i.solution).length||"Recursion"===i.type)&&(c.referenced=i),[]}return"valueExpr"in d&&(l=l.concat(u(d.inverse?n.subject:n.object,d.valueExpr,function(e,t){return f(e,t,s)},function(e,t){return f(e,t,a)}))),0===l.length&&"semActs"in r.c&&!o.dispatchAll(r.c.semActs,n,c)&&l.push({type:"SemActFailure",errors:[{type:"UntrackedSemActFailure"}]}),c}),"annotations"in r.c&&(d.annotations=r.c.annotations),"semActs"in r.c&&(d.semActs=r.c.semActs),c=r.stack.slice(),e},{});return l.length?{type:"SemActFailure",errors:l}:(f.forEach(e=>{for(var t=0;t<e.length;++t)null!==e[t]&&void 0!==e[t]||e.splice(t--,1)}),"semActs"in r&&(h.semActs=r.semActs),h)}}}}();void 0!==e&&void 0!==r&&(t.exports=n)},{"../RdfTerm":48}],53:[function(e,t,r){var n=function(){var t=e("../RdfTerm"),r=-1;function n(e){e||(e={});for(var t,r=1,n=arguments.length;r<n&&(t=arguments[r]||{});r++)for(var i in t)e[i]=t[i];return e}return{name:"threaded-val-nerr",description:"emulation of regular expression engine with error permutations",compile:function(e,i){var s=i.expression;return{match:function(a,o,u,c,l,f,h,p,d,v,g){if(!s)return{};var y=function i(s,a){var o=u.indexOf(s),l="min"in s?s.min:1,f="max"in s?s.max===r?1/0:s.max:1;function h(e,t){var r=0,i=[a],o={};("min"in s&&1!==s.min||"max"in s&&1!==s.max)&&(o.min=s.min,o.max=s.max),"semActs"in s&&(o.semActs=s.semActs),"annotations"in s&&(o.annotations=s.annotations);for(;r<f;++r){for(var u=[],c=0;c<i.length;++c){var h=i[c],p=t(h);if(p.length>0&&0===p[0].errors.length&&p.forEach(t=>{var r="expression"in h?h.expression.solutions:[];"solution"in t&&(r=r.concat(t.solution)),delete t.solution,t.expression=n({type:e,solutions:r},o)}),0===p.length||p[0].errors.length>0)return r<l?p:i;u=u.concat(p)}i=u}if(i.length>0&&0===i[0].errors.length&&"semActs"in s){var v=[],g=[];i.forEach(e=>{d.dispatchAll(s.semActs,"???",e)?v.push(e):(e.errors.push({type:"SemActFailure",errors:[{type:"UntrackedSemActFailure"}]}),g.push(e))}),i=v.length>0?v:g}return i}if("TripleConstraint"===s.type){var p="negated"in s&&s.negated||0===f;p&&(l=f=1/0),void 0===a.avail[o]&&(a.avail[o]=c[o].slice());var v={};("min"in s&&1!==s.min||"max"in s&&1!==s.max)&&(v.min=s.min,v.max=s.max),"semActs"in s&&(v.semActs=s.semActs),"annotations"in s&&(v.annotations=s.annotations);var g=a.avail[o].splice(0,l),y=p?0===g.length:g.length>=l,m=[],b=a.matched;if(y)do{m.push({avail:a.avail.map(e=>e.slice()),errors:a.errors.slice(),matched:b.concat({tNos:g.slice()}),expression:n({type:"TripleConstraintSolutions",predicate:s.predicate,solutions:g.map(e=>({type:"halfTestedTriple",tripleNo:e,constraintNo:o}))},"valueExpr"in s?{valueExpr:s.valueExpr}:{},"productionLabel"in s?{productionLabel:s.productionLabel}:{},v)})}while(a.avail[o].length>0&&g.length<f&&(g.push(a.avail[o].shift()),1));else{var _=n({},s.valueExpr);if("reference"in _){var x=_.reference;t.isBlank(x)&&(_.reference=e.shapes[x])}m.push({avail:a.avail,errors:a.errors.concat([n({type:p?"NegatedProperty":"MissingProperty",property:s.predicate},Object.keys(_).length>0?{valueExpr:_}:{})]),matched:b})}return m}if("OneOf"===s.type)return h("OneOfSolutions",e=>{var t=[],r=[];return s.expressions.forEach(n=>{var s={avail:e.avail.map(e=>e.slice()),errors:e.errors,matched:e.matched},a=i(n,s);0===a[0].errors.length?(t=t.concat(a),a.forEach(e=>{var t="solution"in s?s.solution.expressions:[];"expression"in e&&(t=t.concat([e.expression])),delete e.expression,e.solution={type:"OneOfSolution",expressions:t}})):r=r.concat(a)}),t.length>0?t:r});if("EachOf"===s.type)return h("EachOfSolutions",e=>s.expressions.reduce((e,t)=>e.reduce((e,r)=>{var n=i(t,r);return n.forEach(e=>{if(0===e.errors.length){var t="solution"in r?r.solution.expressions:[];"expression"in e&&(t=t.concat([e.expression])),delete e.expression,e.solution={type:"EachOfSolution",expressions:t}}}),e.concat(n)},[]),[e]));if("Inclusion"===s.type){var w=e.productions[s.include];return i(w,a)}runtimeError("unexpected expr type: "+s.type)}(s,{avail:[],matched:[],errors:[]}),m=y.reduce((e,t)=>{if(t.errors.length>0)return e;var r={};return Object.keys(l).forEach(e=>{void 0!==l[e]&&(r[e]=l[e])}),t.matched.forEach(e=>{e.tNos.forEach(e=>{delete r[e]})}),Object.keys(r).forEach(e=>{t.errors.push({type:"ExcessTripleViolation",triple:f[e],constraint:u[r[e]]})}),null!==e?e:Object.keys(r).length>0?null:t},null);return null!==m?function(e,r,n,s,a,o,u){return Object.keys(e).length>0&&function c(l){if("OneOfSolutions"===l.type||"EachOfSolutions"===l.type)l.solutions.forEach(e=>{e.expressions.forEach(e=>{c(e)})});else{if("TripleConstraintSolutions"!==l.type)throw Error("unexpected expr type in "+JSON.stringify(l));l.solutions=l.solutions.map(c=>{if("TestedTriple"===c.type)return c;var l=n[c.tripleNo],f=r[c.constraintNo],h={type:"TestedTriple",subject:l.subject,predicate:l.predicate,object:function(e){if('"'!==e[0])return e;var r={value:t.getLiteralValue(e)},n=t.getLiteralType(e);n&&"http://www.w3.org/2001/XMLSchema#string"!==n&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"!==n&&(r.type=n);var i=t.getLiteralLanguage(e);return i&&(r.language=i),r}(l.object)};function p(e,r,n){var s=n(e,r);if("errors"in s){var a={type:"ReferenceError",focus:e,shape:r};return"string"==typeof r&&t.isBlank(r)&&(a.referencedShape=i),a.errors=s,[a]}return("solution"in s&&0!==Object.keys(s.solution).length||"Recursion"===s.type)&&(h.referenced=s),[]}var d="valueExpr"in f?u(f.inverse?l.subject:l.object,f.valueExpr,function(e,t){return p(e,t,s)},function(e,t){return p(e,t,a)}):[];return 0===d.length&&"semActs"in f&&!o.dispatchAll(f.semActs,l,h)&&d.push({type:"SemActFailure",errors:[{type:"UntrackedSemActFailure"}]}),d.length>0&&(e.errors=e.errors||[],e.errors=e.errors.concat(d)),h})}}(e),"semActs"in i&&(e.semActs=i.semActs),e}(m.expression,u,f,h,p,d,v):y.length>1?{type:"PossibleErrors",errors:y.reduce((e,t)=>e.concat([t.errors]),[])}:y[0]}}}}}();void 0!==e&&void 0!==r&&(t.exports=n)},{"../RdfTerm":48}],54:[function(e,t,r){var n=function(){return{create:function(){let e={},t={},r={},n={};return{add:function(i,s){if(i in r&&-1!==r[i].indexOf(s))return;let a=i in n?c(i):e[i]=c(i),o=c(s);function u(e,t,r,n){e[n]=e[n].concat(r,e[r]),e[r].forEach(e=>t[e]=t[e].concat(n,t[n]))}function c(e){return e in n||(t[e]=[],r[e]=[],n[e]={}),n[e]}a[s]=o,s in e&&delete e[s],u(r,t,s,i),u(t,r,i,s)},roots:e,parents:t,children:r}},walk:function e(t,r,n){return Object.keys(t).reduce((i,s)=>i.concat(e(t[s],r,s),n?r(s,n):[]),[])}}}();void 0!==e&&void 0!==r&&(t.exports=n)},{}],55:[function(e,t,r){var n={RdfTerm:e("./lib/RdfTerm"),Util:e("./lib/ShExUtil"),Validator:e("./lib/ShExValidator"),Writer:e("./lib/ShExWriter"),"nfax-val-1err":e("./lib/regex/nfax-val-1err"),"threaded-val-nerr":e("./lib/regex/threaded-val-nerr")};void 0!==e&&void 0!==r&&(t.exports=n)},{"./lib/RdfTerm":48,"./lib/ShExUtil":49,"./lib/ShExValidator":50,"./lib/ShExWriter":51,"./lib/regex/nfax-val-1err":52,"./lib/regex/threaded-val-nerr":53}]},{},[6])(6)});